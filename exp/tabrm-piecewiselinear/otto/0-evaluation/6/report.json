{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 6,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.00010643036335747467,
            "weight_decay": 0.0
        },
        "model": {
            "arch_type": "tabrm",
            "sample_rate": 0.12326876001318109,
            "k": 48,
            "backbone": {
                "n_blocks": 1,
                "d_block": 512,
                "dropout": 0.48755694663902815
            },
            "num_embeddings": {
                "type": "PiecewiseLinearEmbeddingsV2",
                "d_embedding": 32
            }
        },
        "bins": {
            "n_bins": 101
        }
    },
    "n_parameters": 3594576,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 2418,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9565972222222222,
                "recall": 0.8923076923076924,
                "f1-score": 0.9233347297863428,
                "support": 1235.0
            },
            "1": {
                "precision": 0.9133827921765103,
                "recall": 0.918782709827486,
                "f1-score": 0.9160747934483259,
                "support": 10318.0
            },
            "2": {
                "precision": 0.8246147993151988,
                "recall": 0.8463490823896915,
                "f1-score": 0.8353405915791502,
                "support": 5122.0
            },
            "3": {
                "precision": 0.934227330779055,
                "recall": 0.8495934959349594,
                "f1-score": 0.8899026763990269,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9807801017524025,
                "recall": 0.9897318881916715,
                "f1-score": 0.9852356615559342,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9916271896000881,
                "recall": 0.9950254256024762,
                "f1-score": 0.9933234012028913,
                "support": 9046.0
            },
            "6": {
                "precision": 0.9628169014084507,
                "recall": 0.9405613648871767,
                "f1-score": 0.9515590200445435,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9879651916311795,
                "recall": 0.9850470740262137,
                "f1-score": 0.9865039748567203,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9612403100775194,
                "recall": 0.9776095868811101,
                "f1-score": 0.969355847404628,
                "support": 3171.0
            },
            "accuracy": 0.9409105830660842,
            "macro avg": {
                "precision": 0.9459168709958473,
                "recall": 0.9327787022276086,
                "f1-score": 0.9389589662530626,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.941314702570417,
                "recall": 0.9409105830660842,
                "f1-score": 0.9409567635726942,
                "support": 39601.0
            },
            "cross-entropy": 0.16788701938389264,
            "score": 0.9409105830660842
        },
        "val": {
            "0": {
                "precision": 0.6472868217054264,
                "recall": 0.5422077922077922,
                "f1-score": 0.5901060070671378,
                "support": 308.0
            },
            "1": {
                "precision": 0.7828723001136795,
                "recall": 0.8007751937984496,
                "f1-score": 0.7917225522130678,
                "support": 2580.0
            },
            "2": {
                "precision": 0.5929270127915726,
                "recall": 0.615144418423107,
                "f1-score": 0.6038314176245212,
                "support": 1281.0
            },
            "3": {
                "precision": 0.6520547945205479,
                "recall": 0.5522041763341067,
                "f1-score": 0.5979899497487436,
                "support": 431.0
            },
            "4": {
                "precision": 0.9678899082568807,
                "recall": 0.9634703196347032,
                "f1-score": 0.965675057208238,
                "support": 438.0
            },
            "5": {
                "precision": 0.9343323049801675,
                "recall": 0.9372236958443855,
                "f1-score": 0.9357757669388655,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7070938215102975,
                "recall": 0.6806167400881057,
                "f1-score": 0.6936026936026937,
                "support": 454.0
            },
            "7": {
                "precision": 0.9118295371050698,
                "recall": 0.9165435745937962,
                "f1-score": 0.9141804788213628,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8500619578686494,
                "recall": 0.8650693568726355,
                "f1-score": 0.8574999999999999,
                "support": 793.0
            },
            "accuracy": 0.8117361882638118,
            "macro avg": {
                "precision": 0.7829276065391434,
                "recall": 0.7636950297552313,
                "f1-score": 0.7722648803582923,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8107143086234074,
                "recall": 0.8117361882638118,
                "f1-score": 0.8108294617006143,
                "support": 9901.0
            },
            "cross-entropy": 0.6023271372450651,
            "score": 0.8117361882638118
        },
        "test": {
            "0": {
                "precision": 0.6548387096774193,
                "recall": 0.5259067357512953,
                "f1-score": 0.5833333333333333,
                "support": 386.0
            },
            "1": {
                "precision": 0.778683574879227,
                "recall": 0.799937965260546,
                "f1-score": 0.7891676866585068,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5735294117647058,
                "recall": 0.584634603372892,
                "f1-score": 0.5790287658521497,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6778523489932886,
                "recall": 0.5631970260223048,
                "f1-score": 0.615228426395939,
                "support": 538.0
            },
            "4": {
                "precision": 0.9727272727272728,
                "recall": 0.9762773722627737,
                "f1-score": 0.9744990892531876,
                "support": 548.0
            },
            "5": {
                "precision": 0.9402460456942003,
                "recall": 0.946232755571277,
                "f1-score": 0.9432299012693934,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7224334600760456,
                "recall": 0.6690140845070423,
                "f1-score": 0.6946983546617916,
                "support": 568.0
            },
            "7": {
                "precision": 0.9054209919261822,
                "recall": 0.9273479031305375,
                "f1-score": 0.9162532827545959,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8558823529411764,
                "recall": 0.8809283551967709,
                "f1-score": 0.868224763799105,
                "support": 991.0
            },
            "accuracy": 0.8123787976729153,
            "macro avg": {
                "precision": 0.7868460187421686,
                "recall": 0.7637196445639377,
                "f1-score": 0.7737404004420002,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8103327579501269,
                "recall": 0.8123787976729153,
                "f1-score": 0.8107800486311945,
                "support": 12376.0
            },
            "cross-entropy": 0.5921233935337987,
            "score": 0.8123787976729153
        }
    },
    "time": "0:02:33.542879",
    "chunk_size": null,
    "eval_batch_size": 32768
}