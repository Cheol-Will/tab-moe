{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 7,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.00010643036335747467,
            "weight_decay": 0.0
        },
        "model": {
            "arch_type": "tabrm",
            "sample_rate": 0.12326876001318109,
            "k": 48,
            "backbone": {
                "n_blocks": 1,
                "d_block": 512,
                "dropout": 0.48755694663902815
            },
            "num_embeddings": {
                "type": "PiecewiseLinearEmbeddingsV2",
                "d_embedding": 32
            }
        },
        "bins": {
            "n_bins": 101
        }
    },
    "n_parameters": 3594576,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 1794,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9442843419788665,
                "recall": 0.7959514170040486,
                "f1-score": 0.8637961335676626,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8771696860476146,
                "recall": 0.8962977321186276,
                "f1-score": 0.8866305546234601,
                "support": 10318.0
            },
            "2": {
                "precision": 0.7778857364943645,
                "recall": 0.7815306520890277,
                "f1-score": 0.779703934553954,
                "support": 5122.0
            },
            "3": {
                "precision": 0.8825015792798484,
                "recall": 0.8112659698025552,
                "f1-score": 0.8453857791225416,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9823160296634341,
                "recall": 0.9823160296634341,
                "f1-score": 0.9823160296634341,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9878385848535103,
                "recall": 0.9877293831527747,
                "f1-score": 0.9877839809850202,
                "support": 9046.0
            },
            "6": {
                "precision": 0.9348072562358276,
                "recall": 0.9075399009356081,
                "f1-score": 0.9209717955878246,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9716687991226467,
                "recall": 0.9813549935388591,
                "f1-score": 0.976487876561352,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9410138248847926,
                "recall": 0.9659413434247871,
                "f1-score": 0.9533146591970122,
                "support": 3171.0
            },
            "accuracy": 0.9170475493043105,
            "macro avg": {
                "precision": 0.9221650931734339,
                "recall": 0.901103046858858,
                "f1-score": 0.9107100826513624,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.9172708717342903,
                "recall": 0.9170475493043105,
                "f1-score": 0.9168439031391995,
                "support": 39601.0
            },
            "cross-entropy": 0.2241209347953229,
            "score": 0.9170475493043105
        },
        "val": {
            "0": {
                "precision": 0.6985645933014354,
                "recall": 0.474025974025974,
                "f1-score": 0.5647969052224371,
                "support": 308.0
            },
            "1": {
                "precision": 0.7685860058309038,
                "recall": 0.8174418604651162,
                "f1-score": 0.7922614575507139,
                "support": 2580.0
            },
            "2": {
                "precision": 0.6180048661800487,
                "recall": 0.594847775175644,
                "f1-score": 0.6062052505966586,
                "support": 1281.0
            },
            "3": {
                "precision": 0.6519480519480519,
                "recall": 0.5823665893271461,
                "f1-score": 0.6151960784313725,
                "support": 431.0
            },
            "4": {
                "precision": 0.9634703196347032,
                "recall": 0.9634703196347032,
                "f1-score": 0.9634703196347032,
                "support": 438.0
            },
            "5": {
                "precision": 0.9441465594280608,
                "recall": 0.9341290893015031,
                "f1-score": 0.9391111111111111,
                "support": 2262.0
            },
            "6": {
                "precision": 0.715261958997722,
                "recall": 0.6916299559471366,
                "f1-score": 0.7032474804031354,
                "support": 454.0
            },
            "7": {
                "precision": 0.9049676025917927,
                "recall": 0.9283604135893648,
                "f1-score": 0.9165147648559969,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8450363196125908,
                "recall": 0.880201765447667,
                "f1-score": 0.8622606547251389,
                "support": 793.0
            },
            "accuracy": 0.8152711847288153,
            "macro avg": {
                "precision": 0.7899984752805899,
                "recall": 0.7629415269904728,
                "f1-score": 0.773673780281252,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8129069807009532,
                "recall": 0.8152711847288153,
                "f1-score": 0.8130459371130193,
                "support": 9901.0
            },
            "cross-entropy": 0.561606828602151,
            "score": 0.8152711847288153
        },
        "test": {
            "0": {
                "precision": 0.706766917293233,
                "recall": 0.48704663212435234,
                "f1-score": 0.5766871165644171,
                "support": 386.0
            },
            "1": {
                "precision": 0.7712166172106825,
                "recall": 0.8061414392059554,
                "f1-score": 0.7882923870185017,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5919165580182529,
                "recall": 0.5671455340412243,
                "f1-score": 0.5792663476874003,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6177606177606177,
                "recall": 0.5947955390334573,
                "f1-score": 0.6060606060606061,
                "support": 538.0
            },
            "4": {
                "precision": 0.9761029411764706,
                "recall": 0.968978102189781,
                "f1-score": 0.9725274725274724,
                "support": 548.0
            },
            "5": {
                "precision": 0.947255880256593,
                "recall": 0.9402193137601698,
                "f1-score": 0.9437244807385051,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7171903881700554,
                "recall": 0.6830985915492958,
                "f1-score": 0.6997294860234445,
                "support": 568.0
            },
            "7": {
                "precision": 0.902229845626072,
                "recall": 0.9320732427643237,
                "f1-score": 0.9169087739686229,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8435114503816794,
                "recall": 0.8920282542885973,
                "f1-score": 0.8670917116233448,
                "support": 991.0
            },
            "accuracy": 0.8123787976729153,
            "macro avg": {
                "precision": 0.7859945795437397,
                "recall": 0.7635029609952395,
                "f1-score": 0.7722542646902572,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8098564905792449,
                "recall": 0.8123787976729153,
                "f1-score": 0.8102324549168867,
                "support": 12376.0
            },
            "cross-entropy": 0.5444357900026654,
            "score": 0.8123787976729153
        }
    },
    "time": "0:02:07.299454",
    "chunk_size": null,
    "eval_batch_size": 32768
}