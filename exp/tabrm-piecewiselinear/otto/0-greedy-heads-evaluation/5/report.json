{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 5,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.00010643036335747467,
            "weight_decay": 0.0
        },
        "model": {
            "arch_type": "tabrm",
            "sample_rate": 0.12326876001318109,
            "k": 48,
            "backbone": {
                "n_blocks": 1,
                "d_block": 512,
                "dropout": 0.48755694663902815
            },
            "num_embeddings": {
                "type": "PiecewiseLinearEmbeddingsV2",
                "d_embedding": 32
            }
        },
        "bins": {
            "n_bins": 101
        }
    },
    "n_parameters": 3594576,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 1248,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.8654750705550329,
                "recall": 0.7449392712550608,
                "f1-score": 0.8006962576153178,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8170105414902243,
                "recall": 0.8788524907927893,
                "f1-score": 0.8468039407946957,
                "support": 10318.0
            },
            "2": {
                "precision": 0.7070728145211768,
                "recall": 0.6616556032799688,
                "f1-score": 0.6836106908724155,
                "support": 5122.0
            },
            "3": {
                "precision": 0.8851195065535852,
                "recall": 0.6666666666666666,
                "f1-score": 0.7605167273931766,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9696799550814149,
                "recall": 0.9851682829435254,
                "f1-score": 0.9773627617430674,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9772802107342773,
                "recall": 0.9843024541233695,
                "f1-score": 0.9807787630115108,
                "support": 9046.0
            },
            "6": {
                "precision": 0.8857625211029826,
                "recall": 0.8662630709961475,
                "f1-score": 0.87590428491931,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9634996331621424,
                "recall": 0.969724940003692,
                "f1-score": 0.9666022633176925,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9237918215613383,
                "recall": 0.9403973509933775,
                "f1-score": 0.9320206282231599,
                "support": 3171.0
            },
            "accuracy": 0.8829322491856266,
            "macro avg": {
                "precision": 0.8882991194180194,
                "recall": 0.8553300145616219,
                "f1-score": 0.8693662575433718,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.8823756181134008,
                "recall": 0.8829322491856266,
                "f1-score": 0.8814355261790824,
                "support": 39601.0
            },
            "cross-entropy": 0.2996742837350634,
            "score": 0.8829322491856266
        },
        "val": {
            "0": {
                "precision": 0.6239669421487604,
                "recall": 0.4902597402597403,
                "f1-score": 0.5490909090909091,
                "support": 308.0
            },
            "1": {
                "precision": 0.7640128525526597,
                "recall": 0.8294573643410853,
                "f1-score": 0.7953911912283961,
                "support": 2580.0
            },
            "2": {
                "precision": 0.6287878787878788,
                "recall": 0.5831381733021077,
                "f1-score": 0.6051032806804374,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7225609756097561,
                "recall": 0.5498839907192575,
                "f1-score": 0.6245059288537549,
                "support": 431.0
            },
            "4": {
                "precision": 0.9636363636363636,
                "recall": 0.9680365296803652,
                "f1-score": 0.9658314350797266,
                "support": 438.0
            },
            "5": {
                "precision": 0.9335094671950682,
                "recall": 0.9372236958443855,
                "f1-score": 0.9353628943304655,
                "support": 2262.0
            },
            "6": {
                "precision": 0.698237885462555,
                "recall": 0.698237885462555,
                "f1-score": 0.698237885462555,
                "support": 454.0
            },
            "7": {
                "precision": 0.9128843338213762,
                "recall": 0.9209748892171344,
                "f1-score": 0.9169117647058824,
                "support": 1354.0
            },
            "8": {
                "precision": 0.842170160295931,
                "recall": 0.8612862547288777,
                "f1-score": 0.8516209476309227,
                "support": 793.0
            },
            "accuracy": 0.8146651853348147,
            "macro avg": {
                "precision": 0.7877518732789276,
                "recall": 0.7598331692839454,
                "f1-score": 0.7713395818958945,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8115133318007823,
                "recall": 0.8146651853348147,
                "f1-score": 0.811856136519583,
                "support": 9901.0
            },
            "cross-entropy": 0.536324755583946,
            "score": 0.8146651853348147
        },
        "test": {
            "0": {
                "precision": 0.6428571428571429,
                "recall": 0.4896373056994819,
                "f1-score": 0.5558823529411764,
                "support": 386.0
            },
            "1": {
                "precision": 0.7575064340863598,
                "recall": 0.8216501240694789,
                "f1-score": 0.7882755542330011,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5870307167235495,
                "recall": 0.5371642723297939,
                "f1-score": 0.5609915198956296,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6930455635491607,
                "recall": 0.5371747211895911,
                "f1-score": 0.6052356020942409,
                "support": 538.0
            },
            "4": {
                "precision": 0.9655172413793104,
                "recall": 0.9708029197080292,
                "f1-score": 0.9681528662420382,
                "support": 548.0
            },
            "5": {
                "precision": 0.9409282700421941,
                "recall": 0.9465864874425186,
                "f1-score": 0.9437488979016047,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7132486388384754,
                "recall": 0.6919014084507042,
                "f1-score": 0.7024128686327078,
                "support": 568.0
            },
            "7": {
                "precision": 0.8998849252013809,
                "recall": 0.9238038984051978,
                "f1-score": 0.9116875546487904,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8537782139352306,
                "recall": 0.8779011099899092,
                "f1-score": 0.8656716417910447,
                "support": 991.0
            },
            "accuracy": 0.8097931480284422,
            "macro avg": {
                "precision": 0.7837552385125339,
                "recall": 0.7551802496983006,
                "f1-score": 0.7668954287089149,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8053386048983745,
                "recall": 0.8097931480284422,
                "f1-score": 0.8062862955598961,
                "support": 12376.0
            },
            "cross-entropy": 0.5271710430128197,
            "score": 0.8097931480284422
        }
    },
    "time": "0:01:44.885848",
    "chunk_size": null,
    "eval_batch_size": 32768,
    "heads": [
        36,
        46
    ],
    "head_selection_time": "0:00:02.066476"
}