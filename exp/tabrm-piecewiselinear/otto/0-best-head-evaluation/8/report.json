{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 8,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.00010643036335747467,
            "weight_decay": 0.0
        },
        "model": {
            "arch_type": "tabrm",
            "sample_rate": 0.12326876001318109,
            "k": 48,
            "backbone": {
                "n_blocks": 1,
                "d_block": 512,
                "dropout": 0.48755694663902815
            },
            "num_embeddings": {
                "type": "PiecewiseLinearEmbeddingsV2",
                "d_embedding": 32
            }
        },
        "bins": {
            "n_bins": 101
        }
    },
    "n_parameters": 3594576,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 1092,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.8611111111111112,
                "recall": 0.702834008097166,
                "f1-score": 0.7739634418189925,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8010122535961641,
                "recall": 0.8742973444465981,
                "f1-score": 0.8360518999073215,
                "support": 10318.0
            },
            "2": {
                "precision": 0.6948608137044968,
                "recall": 0.633541585318235,
                "f1-score": 0.6627859477124183,
                "support": 5122.0
            },
            "3": {
                "precision": 0.8583270535041447,
                "recall": 0.6614401858304297,
                "f1-score": 0.747130206625123,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9755820556501987,
                "recall": 0.980034227039361,
                "f1-score": 0.9778030734206032,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9794398755278951,
                "recall": 0.9742427592305991,
                "f1-score": 0.9768344047882953,
                "support": 9046.0
            },
            "6": {
                "precision": 0.8443726440495423,
                "recall": 0.8629609246009906,
                "f1-score": 0.8535655960805661,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9521044992743106,
                "recall": 0.9688019198818534,
                "f1-score": 0.9603806386677647,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9176543980037429,
                "recall": 0.9277830337432986,
                "f1-score": 0.9226909204955307,
                "support": 3171.0
            },
            "accuracy": 0.8727557384914523,
            "macro avg": {
                "precision": 0.8760516338246229,
                "recall": 0.8428817764653924,
                "f1-score": 0.8568006810574018,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.8721319827583389,
                "recall": 0.8727557384914523,
                "f1-score": 0.8710202399923209,
                "support": 39601.0
            },
            "cross-entropy": 0.3234627776270555,
            "score": 0.8727557384914523
        },
        "val": {
            "0": {
                "precision": 0.6680672268907563,
                "recall": 0.5162337662337663,
                "f1-score": 0.5824175824175825,
                "support": 308.0
            },
            "1": {
                "precision": 0.7523445640847517,
                "recall": 0.8395348837209302,
                "f1-score": 0.7935519325883862,
                "support": 2580.0
            },
            "2": {
                "precision": 0.6268656716417911,
                "recall": 0.5573770491803278,
                "f1-score": 0.5900826446280991,
                "support": 1281.0
            },
            "3": {
                "precision": 0.6746987951807228,
                "recall": 0.5197215777262181,
                "f1-score": 0.5871559633027523,
                "support": 431.0
            },
            "4": {
                "precision": 0.9634703196347032,
                "recall": 0.9634703196347032,
                "f1-score": 0.9634703196347032,
                "support": 438.0
            },
            "5": {
                "precision": 0.9393398751115076,
                "recall": 0.9310344827586207,
                "f1-score": 0.9351687388987567,
                "support": 2262.0
            },
            "6": {
                "precision": 0.6774891774891775,
                "recall": 0.6894273127753304,
                "f1-score": 0.6834061135371179,
                "support": 454.0
            },
            "7": {
                "precision": 0.9192364170337739,
                "recall": 0.9246676514032496,
                "f1-score": 0.9219440353460973,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8504326328800988,
                "recall": 0.8675914249684742,
                "f1-score": 0.8589263420724095,
                "support": 793.0
            },
            "accuracy": 0.8124431875568124,
            "macro avg": {
                "precision": 0.7857716311052537,
                "recall": 0.7565620520446245,
                "f1-score": 0.7684581858251005,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8094162062354311,
                "recall": 0.8124431875568124,
                "f1-score": 0.8092887148239175,
                "support": 9901.0
            },
            "cross-entropy": 0.5313007876599425,
            "score": 0.8124431875568124
        },
        "test": {
            "0": {
                "precision": 0.6655405405405406,
                "recall": 0.5103626943005182,
                "f1-score": 0.5777126099706745,
                "support": 386.0
            },
            "1": {
                "precision": 0.748587570621469,
                "recall": 0.8219602977667494,
                "f1-score": 0.7835600236546423,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5840830449826989,
                "recall": 0.5271705184259837,
                "f1-score": 0.5541694024950754,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6769596199524941,
                "recall": 0.5297397769516728,
                "f1-score": 0.59436913451512,
                "support": 538.0
            },
            "4": {
                "precision": 0.9742647058823529,
                "recall": 0.9671532846715328,
                "f1-score": 0.9706959706959707,
                "support": 548.0
            },
            "5": {
                "precision": 0.9451566951566952,
                "recall": 0.9388043862752034,
                "f1-score": 0.9419698314108251,
                "support": 2827.0
            },
            "6": {
                "precision": 0.699825479930192,
                "recall": 0.7059859154929577,
                "f1-score": 0.7028921998247152,
                "support": 568.0
            },
            "7": {
                "precision": 0.9074609600925391,
                "recall": 0.9267572356763142,
                "f1-score": 0.9170075978959673,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8470588235294118,
                "recall": 0.8718466195761857,
                "f1-score": 0.8592739930382894,
                "support": 991.0
            },
            "accuracy": 0.8075307045895281,
            "macro avg": {
                "precision": 0.7832152711875993,
                "recall": 0.7555311921263463,
                "f1-score": 0.7668500848334756,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.803877570707028,
                "recall": 0.8075307045895281,
                "f1-score": 0.8043275417464485,
                "support": 12376.0
            },
            "cross-entropy": 0.5170424028637209,
            "score": 0.8075307045895281
        }
    },
    "time": "0:01:38.024293",
    "chunk_size": null,
    "eval_batch_size": 32768,
    "heads": [
        24
    ],
    "head_selection_time": "0:00:00.673165"
}