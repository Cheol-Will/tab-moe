{
    "function": "bin.tune.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 0,
        "function": "bin.model.main",
        "n_trials": 50,
        "sampler": {
            "n_startup_trials": 20
        },
        "space": {
            "seed": 0,
            "batch_size": 1024,
            "patience": 16,
            "n_epochs": -1,
            "gradient_clipping_norm": 1.0,
            "amp": true,
            "data": {
                "cache": true,
                "path": "data/covtype2",
                "num_policy": "noisy-quantile",
                "cat_policy": "ordinal"
            },
            "optimizer": {
                "type": "AdamW",
                "lr": [
                    "_tune_",
                    "loguniform",
                    0.0001,
                    0.003
                ],
                "weight_decay": [
                    "_tune_",
                    "?loguniform",
                    0.0,
                    0.0001,
                    0.1
                ]
            },
            "model": {
                "arch_type": "moe-sparse",
                "backbone": {
                    "k": [
                        "_tune_",
                        "int",
                        1,
                        4
                    ],
                    "n_blocks": [
                        "_tune_",
                        "int",
                        1,
                        5
                    ],
                    "d_block": [
                        "_tune_",
                        "int",
                        64,
                        1024,
                        16
                    ],
                    "dropout": [
                        "_tune_",
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ],
                    "moe_ratio": [
                        "_tune_",
                        "float",
                        0.25,
                        1.0,
                        0.25
                    ],
                    "num_experts": [
                        "_tune_",
                        "int",
                        4,
                        32,
                        4
                    ]
                }
            }
        }
    },
    "best": {
        "function": "bin.model.main",
        "gpus": [
            "NVIDIA GeForce RTX 4090"
        ],
        "config": {
            "seed": 0,
            "batch_size": 1024,
            "patience": 16,
            "n_epochs": -1,
            "gradient_clipping_norm": 1.0,
            "amp": true,
            "data": {
                "cache": true,
                "path": "data/covtype2",
                "num_policy": "noisy-quantile",
                "cat_policy": "ordinal"
            },
            "optimizer": {
                "type": "AdamW",
                "lr": 0.00023846058122103342,
                "weight_decay": 0.0011769063175902181
            },
            "model": {
                "arch_type": "moe-sparse",
                "backbone": {
                    "k": 4,
                    "n_blocks": 5,
                    "d_block": 928,
                    "dropout": 0.19075546952152095,
                    "moe_ratio": 0.25,
                    "num_experts": 8
                }
            }
        },
        "n_parameters": 17322055,
        "prediction_type": "probs",
        "epoch_size": 364,
        "best_step": 61516,
        "metrics": {
            "train": {
                "0": {
                    "precision": 0.9847881602284352,
                    "recall": 0.9869890395196861,
                    "f1-score": 0.9858873715736078,
                    "support": 135578.0
                },
                "1": {
                    "precision": 0.9906619136711355,
                    "recall": 0.9870885545358278,
                    "f1-score": 0.9888720059673454,
                    "support": 181312.0
                },
                "2": {
                    "precision": 0.9935959294674972,
                    "recall": 0.9899484310811992,
                    "f1-score": 0.991768826619965,
                    "support": 22882.0
                },
                "3": {
                    "precision": 0.9569247546346783,
                    "recall": 0.9977259806708357,
                    "f1-score": 0.976899526857779,
                    "support": 1759.0
                },
                "4": {
                    "precision": 0.9564231329985421,
                    "recall": 0.9718518518518519,
                    "f1-score": 0.9640757674722404,
                    "support": 6075.0
                },
                "5": {
                    "precision": 0.9814864263462394,
                    "recall": 0.9920827710301394,
                    "f1-score": 0.9867561521252797,
                    "support": 11115.0
                },
                "6": {
                    "precision": 0.9770877298763944,
                    "recall": 0.9876580831936614,
                    "f1-score": 0.9823444722285367,
                    "support": 13126.0
                },
                "accuracy": 0.9871990361627229,
                "macro avg": {
                    "precision": 0.9772811496032745,
                    "recall": 0.9876206731261716,
                    "f1-score": 0.9823720175492505,
                    "support": 371847.0
                },
                "weighted avg": {
                    "precision": 0.9872284581686326,
                    "recall": 0.9871990361627229,
                    "f1-score": 0.9872066420553531,
                    "support": 371847.0
                },
                "cross-entropy": 0.03232685855271883,
                "score": 0.9871990361627229
            },
            "val": {
                "0": {
                    "precision": 0.9625715543813298,
                    "recall": 0.9674278633386441,
                    "f1-score": 0.9649935990817994,
                    "support": 33894.0
                },
                "1": {
                    "precision": 0.9744535276346188,
                    "recall": 0.9677462054359336,
                    "f1-score": 0.9710882847781812,
                    "support": 45328.0
                },
                "2": {
                    "precision": 0.9680516759776536,
                    "recall": 0.9692361475266562,
                    "f1-score": 0.9686435496549917,
                    "support": 5721.0
                },
                "3": {
                    "precision": 0.8905579399141631,
                    "recall": 0.9453302961275627,
                    "f1-score": 0.9171270718232044,
                    "support": 439.0
                },
                "4": {
                    "precision": 0.8845401174168297,
                    "recall": 0.8926925608953259,
                    "f1-score": 0.888597640891219,
                    "support": 1519.0
                },
                "5": {
                    "precision": 0.935244161358811,
                    "recall": 0.9510615329255128,
                    "f1-score": 0.9430865298840321,
                    "support": 2779.0
                },
                "6": {
                    "precision": 0.9549278846153846,
                    "recall": 0.9683120048750762,
                    "f1-score": 0.9615733736762481,
                    "support": 3282.0
                },
                "accuracy": 0.9659108022632904,
                "macro avg": {
                    "precision": 0.9386209801855416,
                    "recall": 0.9516866587321016,
                    "f1-score": 0.945015721398525,
                    "support": 92962.0
                },
                "weighted avg": {
                    "precision": 0.9660005337535043,
                    "recall": 0.9659108022632904,
                    "f1-score": 0.9659399802852504,
                    "support": 92962.0
                },
                "cross-entropy": 0.11129036742158223,
                "score": 0.9659108022632904
            },
            "test": {
                "0": {
                    "precision": 0.9622730266252705,
                    "recall": 0.9656344410876133,
                    "f1-score": 0.9639508034494133,
                    "support": 42368.0
                },
                "1": {
                    "precision": 0.9726972750496736,
                    "recall": 0.9676673549707911,
                    "f1-score": 0.9701757955922815,
                    "support": 56661.0
                },
                "2": {
                    "precision": 0.9659550718571229,
                    "recall": 0.968116347364005,
                    "f1-score": 0.9670345020254225,
                    "support": 7151.0
                },
                "3": {
                    "precision": 0.8773747841105354,
                    "recall": 0.9253187613843351,
                    "f1-score": 0.900709219858156,
                    "support": 549.0
                },
                "4": {
                    "precision": 0.8908320084790673,
                    "recall": 0.885202738283307,
                    "f1-score": 0.8880084521922874,
                    "support": 1899.0
                },
                "5": {
                    "precision": 0.9302456933069755,
                    "recall": 0.9484595450619061,
                    "f1-score": 0.9392643284858855,
                    "support": 3473.0
                },
                "6": {
                    "precision": 0.9560916767189385,
                    "recall": 0.9661140906874696,
                    "f1-score": 0.9610767551837031,
                    "support": 4102.0
                },
                "accuracy": 0.9647771572162509,
                "macro avg": {
                    "precision": 0.9364956480210834,
                    "recall": 0.9466447541199182,
                    "f1-score": 0.9414599795410215,
                    "support": 116203.0
                },
                "weighted avg": {
                    "precision": 0.9648385042024212,
                    "recall": 0.9647771572162509,
                    "f1-score": 0.9647967900449481,
                    "support": 116203.0
                },
                "cross-entropy": 0.11402846337041049,
                "score": 0.9647771572162509
            }
        },
        "time": "0:22:59.055058",
        "chunk_size": null,
        "eval_batch_size": 32768,
        "trial_id": 26,
        "tuning_time": "6:02:10.435662"
    },
    "time": "7:30:19.567563",
    "n_completed_trials": 32
}