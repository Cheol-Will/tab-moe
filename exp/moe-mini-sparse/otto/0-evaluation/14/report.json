{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 14,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0003773791701581441,
            "weight_decay": 0.0
        },
        "model": {
            "arch_type": "moe-sparse",
            "backbone": {
                "k": 2,
                "n_blocks": 2,
                "d_block": 832,
                "dropout": 0.48234583879181137,
                "moe_ratio": 0.75,
                "num_experts": 8
            }
        }
    },
    "n_parameters": 16712393,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 3432,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.967420814479638,
                "recall": 0.8655870445344129,
                "f1-score": 0.9136752136752138,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8376816827660919,
                "recall": 0.8993021903469665,
                "f1-score": 0.8673989249824725,
                "support": 10318.0
            },
            "2": {
                "precision": 0.7498433911046147,
                "recall": 0.7010933229207341,
                "f1-score": 0.7246493794773483,
                "support": 5122.0
            },
            "3": {
                "precision": 0.9386590584878745,
                "recall": 0.7642276422764228,
                "f1-score": 0.8425096030729834,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9869983041266253,
                "recall": 0.9960068454078722,
                "f1-score": 0.9914821124361158,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9924124079446552,
                "recall": 0.983196993146142,
                "f1-score": 0.9877832074633496,
                "support": 9046.0
            },
            "6": {
                "precision": 0.9355555555555556,
                "recall": 0.9268024215740231,
                "f1-score": 0.9311584185789328,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9853757867456497,
                "recall": 0.9826472217094333,
                "f1-score": 0.9840096127183658,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9417298937784522,
                "recall": 0.978555660674866,
                "f1-score": 0.9597896690380452,
                "support": 3171.0
            },
            "accuracy": 0.909194212267367,
            "macro avg": {
                "precision": 0.926186321665462,
                "recall": 0.8997132602878748,
                "f1-score": 0.9113840157158697,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.9097374889632907,
                "recall": 0.909194212267367,
                "f1-score": 0.9085631588096164,
                "support": 39601.0
            },
            "cross-entropy": 0.22368958196987523,
            "score": 0.909194212267367
        },
        "val": {
            "0": {
                "precision": 0.6666666666666666,
                "recall": 0.5324675324675324,
                "f1-score": 0.592057761732852,
                "support": 308.0
            },
            "1": {
                "precision": 0.7574559827524254,
                "recall": 0.8170542635658915,
                "f1-score": 0.7861271676300577,
                "support": 2580.0
            },
            "2": {
                "precision": 0.6070549630844955,
                "recall": 0.5776736924277908,
                "f1-score": 0.592,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7280966767371602,
                "recall": 0.5591647331786543,
                "f1-score": 0.6325459317585301,
                "support": 431.0
            },
            "4": {
                "precision": 0.9569160997732427,
                "recall": 0.9634703196347032,
                "f1-score": 0.9601820250284414,
                "support": 438.0
            },
            "5": {
                "precision": 0.9360284318080853,
                "recall": 0.9314765694076039,
                "f1-score": 0.9337469532461776,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7130044843049327,
                "recall": 0.7004405286343612,
                "f1-score": 0.7066666666666667,
                "support": 454.0
            },
            "7": {
                "precision": 0.915929203539823,
                "recall": 0.9172821270310192,
                "f1-score": 0.9166051660516605,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8381642512077294,
                "recall": 0.8751576292559899,
                "f1-score": 0.8562615669339914,
                "support": 793.0
            },
            "accuracy": 0.8116351883648116,
            "macro avg": {
                "precision": 0.7910351955416178,
                "recall": 0.7637985995115052,
                "f1-score": 0.7751325821164864,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8096130529588127,
                "recall": 0.8116351883648116,
                "f1-score": 0.809530552365597,
                "support": 9901.0
            },
            "cross-entropy": 0.604474747135795,
            "score": 0.8116351883648116
        },
        "test": {
            "0": {
                "precision": 0.6941580756013745,
                "recall": 0.5233160621761658,
                "f1-score": 0.5967503692762186,
                "support": 386.0
            },
            "1": {
                "precision": 0.7589595375722543,
                "recall": 0.8145161290322581,
                "f1-score": 0.7857570317175344,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5843812045003309,
                "recall": 0.551530293566521,
                "f1-score": 0.5674807197943446,
                "support": 1601.0
            },
            "3": {
                "precision": 0.678082191780822,
                "recall": 0.5520446096654275,
                "f1-score": 0.6086065573770492,
                "support": 538.0
            },
            "4": {
                "precision": 0.9673321234119783,
                "recall": 0.9726277372262774,
                "f1-score": 0.9699727024567789,
                "support": 548.0
            },
            "5": {
                "precision": 0.9477982954545454,
                "recall": 0.9441103643438273,
                "f1-score": 0.9459507354244195,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7223230490018149,
                "recall": 0.7007042253521126,
                "f1-score": 0.711349419124218,
                "support": 568.0
            },
            "7": {
                "precision": 0.9131455399061033,
                "recall": 0.9190785587714116,
                "f1-score": 0.916102443332352,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8529411764705882,
                "recall": 0.9071644803229062,
                "f1-score": 0.8792176039119804,
                "support": 991.0
            },
            "accuracy": 0.8131060116354234,
            "macro avg": {
                "precision": 0.7910134659666457,
                "recall": 0.7650102733841009,
                "f1-score": 0.7756875091572106,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8101370778566881,
                "recall": 0.8131060116354234,
                "f1-score": 0.8105731734930267,
                "support": 12376.0
            },
            "cross-entropy": 0.5997265961925018,
            "score": 0.8131060116354234
        }
    },
    "time": "0:01:01.018804",
    "chunk_size": null,
    "eval_batch_size": 32768
}