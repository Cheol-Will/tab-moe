{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 11,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0003773791701581441,
            "weight_decay": 0.0
        },
        "model": {
            "arch_type": "moe-sparse",
            "backbone": {
                "k": 2,
                "n_blocks": 2,
                "d_block": 832,
                "dropout": 0.48234583879181137,
                "moe_ratio": 0.75,
                "num_experts": 8
            }
        }
    },
    "n_parameters": 16712393,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 3822,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9716636197440585,
                "recall": 0.8607287449392712,
                "f1-score": 0.9128381279519105,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8306197478991597,
                "recall": 0.9196549718937779,
                "f1-score": 0.8728727807929354,
                "support": 10318.0
            },
            "2": {
                "precision": 0.7856328392246295,
                "recall": 0.6725888324873096,
                "f1-score": 0.7247291469443569,
                "support": 5122.0
            },
            "3": {
                "precision": 0.9469476744186046,
                "recall": 0.756678281068525,
                "f1-score": 0.841187863137508,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9920589903573455,
                "recall": 0.9977181973759269,
                "f1-score": 0.9948805460750852,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9850746268656716,
                "recall": 0.9849657307097059,
                "f1-score": 0.9850201757780112,
                "support": 9046.0
            },
            "6": {
                "precision": 0.925845147219193,
                "recall": 0.9345074298293891,
                "f1-score": 0.9301561216105176,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9777940906588365,
                "recall": 0.983570241831272,
                "f1-score": 0.9806736609607951,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9492417208294646,
                "recall": 0.967202775149795,
                "f1-score": 0.9581380818494221,
                "support": 3171.0
            },
            "accuracy": 0.910381050983561,
            "macro avg": {
                "precision": 0.9294309396907737,
                "recall": 0.8975128005872192,
                "f1-score": 0.9111662783445047,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.9106859834381591,
                "recall": 0.910381050983561,
                "f1-score": 0.9088008254970042,
                "support": 39601.0
            },
            "cross-entropy": 0.2224730520684392,
            "score": 0.910381050983561
        },
        "val": {
            "0": {
                "precision": 0.6213235294117647,
                "recall": 0.5487012987012987,
                "f1-score": 0.5827586206896551,
                "support": 308.0
            },
            "1": {
                "precision": 0.7454669859733151,
                "recall": 0.8445736434108527,
                "f1-score": 0.7919316736325641,
                "support": 2580.0
            },
            "2": {
                "precision": 0.6239554317548747,
                "recall": 0.5245901639344263,
                "f1-score": 0.5699745547073791,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7207792207792207,
                "recall": 0.5150812064965197,
                "f1-score": 0.6008119079837618,
                "support": 431.0
            },
            "4": {
                "precision": 0.9789719626168224,
                "recall": 0.95662100456621,
                "f1-score": 0.9676674364896073,
                "support": 438.0
            },
            "5": {
                "precision": 0.9439252336448598,
                "recall": 0.9376657824933687,
                "f1-score": 0.9407850964737192,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7238307349665924,
                "recall": 0.7158590308370044,
                "f1-score": 0.7198228128460686,
                "support": 454.0
            },
            "7": {
                "precision": 0.9015804597701149,
                "recall": 0.9268833087149188,
                "f1-score": 0.9140568099053168,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8496894409937888,
                "recall": 0.862547288776797,
                "f1-score": 0.8560700876095119,
                "support": 793.0
            },
            "accuracy": 0.8126451873548126,
            "macro avg": {
                "precision": 0.7899469999901504,
                "recall": 0.7591691919923774,
                "f1-score": 0.7715421111486204,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8091835818751943,
                "recall": 0.8126451873548126,
                "f1-score": 0.8087012415503324,
                "support": 9901.0
            },
            "cross-entropy": 0.6057119302468633,
            "score": 0.8126451873548126
        },
        "test": {
            "0": {
                "precision": 0.6526946107784432,
                "recall": 0.5647668393782384,
                "f1-score": 0.6055555555555556,
                "support": 386.0
            },
            "1": {
                "precision": 0.7475382932166302,
                "recall": 0.8477047146401985,
                "f1-score": 0.7944767441860465,
                "support": 3224.0
            },
            "2": {
                "precision": 0.6257530120481928,
                "recall": 0.5190505933791381,
                "f1-score": 0.5674291567087744,
                "support": 1601.0
            },
            "3": {
                "precision": 0.694300518134715,
                "recall": 0.49814126394052044,
                "f1-score": 0.5800865800865801,
                "support": 538.0
            },
            "4": {
                "precision": 0.9777365491651205,
                "recall": 0.9616788321167883,
                "f1-score": 0.9696412143514259,
                "support": 548.0
            },
            "5": {
                "precision": 0.9437609841827768,
                "recall": 0.949770074283693,
                "f1-score": 0.9467559943582511,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7140287769784173,
                "recall": 0.698943661971831,
                "f1-score": 0.7064056939501779,
                "support": 568.0
            },
            "7": {
                "precision": 0.9178403755868545,
                "recall": 0.9238038984051978,
                "f1-score": 0.920812481601413,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8540856031128404,
                "recall": 0.8859737638748738,
                "f1-score": 0.8697374938088163,
                "support": 991.0
            },
            "accuracy": 0.8161764705882353,
            "macro avg": {
                "precision": 0.7919709692448879,
                "recall": 0.7610926268878311,
                "f1-score": 0.7734334349563379,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8118172829056913,
                "recall": 0.8161764705882353,
                "f1-score": 0.8117004307589183,
                "support": 12376.0
            },
            "cross-entropy": 0.6049860184203183,
            "score": 0.8161764705882353
        }
    },
    "time": "0:01:06.825280",
    "chunk_size": null,
    "eval_batch_size": 32768
}