{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 2,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0003773791701581441,
            "weight_decay": 0.0
        },
        "model": {
            "arch_type": "moe-sparse",
            "backbone": {
                "k": 2,
                "n_blocks": 2,
                "d_block": 832,
                "dropout": 0.48234583879181137,
                "moe_ratio": 0.75,
                "num_experts": 8
            }
        }
    },
    "n_parameters": 16712393,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 2886,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9531100478468899,
                "recall": 0.8064777327935223,
                "f1-score": 0.8736842105263158,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8196893000523652,
                "recall": 0.9102539251792983,
                "f1-score": 0.8626010286554003,
                "support": 10318.0
            },
            "2": {
                "precision": 0.7521252796420582,
                "recall": 0.6563842249121437,
                "f1-score": 0.7010008340283569,
                "support": 5122.0
            },
            "3": {
                "precision": 0.9475683890577508,
                "recall": 0.724157955865273,
                "f1-score": 0.8209348255431205,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9920544835414302,
                "recall": 0.9971477467199087,
                "f1-score": 0.9945945945945945,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9799534832207332,
                "recall": 0.9781118726508954,
                "f1-score": 0.9790318118948823,
                "support": 9046.0
            },
            "6": {
                "precision": 0.8922056384742952,
                "recall": 0.8882773802971932,
                "f1-score": 0.8902371759514617,
                "support": 1817.0
            },
            "7": {
                "precision": 0.968083166149918,
                "recall": 0.9798781613439173,
                "f1-score": 0.9739449541284404,
                "support": 5417.0
            },
            "8": {
                "precision": 0.934964385258594,
                "recall": 0.9520655944497004,
                "f1-score": 0.9434375,
                "support": 3171.0
            },
            "accuracy": 0.8973005732178481,
            "macro avg": {
                "precision": 0.9155282414715595,
                "recall": 0.8769727326902058,
                "f1-score": 0.8932741039247303,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.8977674931434828,
                "recall": 0.8973005732178481,
                "f1-score": 0.8956440652404716,
                "support": 39601.0
            },
            "cross-entropy": 0.2570062846103401,
            "score": 0.8973005732178481
        },
        "val": {
            "0": {
                "precision": 0.6940639269406392,
                "recall": 0.4935064935064935,
                "f1-score": 0.5768500948766604,
                "support": 308.0
            },
            "1": {
                "precision": 0.7481228668941979,
                "recall": 0.8496124031007752,
                "f1-score": 0.7956442831215971,
                "support": 2580.0
            },
            "2": {
                "precision": 0.621841155234657,
                "recall": 0.5378610460577674,
                "f1-score": 0.5768103809125157,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7508305647840532,
                "recall": 0.5243619489559165,
                "f1-score": 0.6174863387978141,
                "support": 431.0
            },
            "4": {
                "precision": 0.9680365296803652,
                "recall": 0.9680365296803652,
                "f1-score": 0.9680365296803652,
                "support": 438.0
            },
            "5": {
                "precision": 0.9388839681133747,
                "recall": 0.9372236958443855,
                "f1-score": 0.9380530973451329,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7120879120879121,
                "recall": 0.7136563876651982,
                "f1-score": 0.7128712871287128,
                "support": 454.0
            },
            "7": {
                "precision": 0.9000713775874375,
                "recall": 0.931314623338257,
                "f1-score": 0.915426497277677,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8697850821744627,
                "recall": 0.8675914249684742,
                "f1-score": 0.8686868686868687,
                "support": 793.0
            },
            "accuracy": 0.8156751843248157,
            "macro avg": {
                "precision": 0.8004137092774556,
                "recall": 0.758129394790848,
                "f1-score": 0.7744294864252604,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8124022667145111,
                "recall": 0.8156751843248157,
                "f1-score": 0.8113663896960216,
                "support": 9901.0
            },
            "cross-entropy": 0.5530683677997255,
            "score": 0.8156751843248157
        },
        "test": {
            "0": {
                "precision": 0.6911196911196911,
                "recall": 0.4637305699481865,
                "f1-score": 0.5550387596899223,
                "support": 386.0
            },
            "1": {
                "precision": 0.7434282584884995,
                "recall": 0.84212158808933,
                "f1-score": 0.7897033158813263,
                "support": 3224.0
            },
            "2": {
                "precision": 0.6079881656804734,
                "recall": 0.5134291068082448,
                "f1-score": 0.5567219776498477,
                "support": 1601.0
            },
            "3": {
                "precision": 0.7135549872122762,
                "recall": 0.5185873605947955,
                "f1-score": 0.6006458557588804,
                "support": 538.0
            },
            "4": {
                "precision": 0.9709090909090909,
                "recall": 0.9744525547445255,
                "f1-score": 0.9726775956284153,
                "support": 548.0
            },
            "5": {
                "precision": 0.9412805093738946,
                "recall": 0.9412805093738946,
                "f1-score": 0.9412805093738946,
                "support": 2827.0
            },
            "6": {
                "precision": 0.6914893617021277,
                "recall": 0.6866197183098591,
                "f1-score": 0.6890459363957597,
                "support": 568.0
            },
            "7": {
                "precision": 0.9053664166185805,
                "recall": 0.9267572356763142,
                "f1-score": 0.9159369527145358,
                "support": 1693.0
            },
            "8": {
                "precision": 0.851145038167939,
                "recall": 0.900100908173562,
                "f1-score": 0.8749386954389405,
                "support": 991.0
            },
            "accuracy": 0.8113283775048481,
            "macro avg": {
                "precision": 0.7906979465858414,
                "recall": 0.7518977279687459,
                "f1-score": 0.7662210665035025,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8066387167047866,
                "recall": 0.8113283775048481,
                "f1-score": 0.806226464985476,
                "support": 12376.0
            },
            "cross-entropy": 0.5532999146603738,
            "score": 0.8113283775048481
        }
    },
    "time": "0:00:56.145263",
    "chunk_size": null,
    "eval_batch_size": 32768
}