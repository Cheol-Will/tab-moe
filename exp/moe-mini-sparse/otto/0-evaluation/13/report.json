{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 13,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0003773791701581441,
            "weight_decay": 0.0
        },
        "model": {
            "arch_type": "moe-sparse",
            "backbone": {
                "k": 2,
                "n_blocks": 2,
                "d_block": 832,
                "dropout": 0.48234583879181137,
                "moe_ratio": 0.75,
                "num_experts": 8
            }
        }
    },
    "n_parameters": 16712393,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 3822,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9792979297929792,
                "recall": 0.8809716599190284,
                "f1-score": 0.927536231884058,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8884359152828876,
                "recall": 0.865962395813142,
                "f1-score": 0.8770552147239264,
                "support": 10318.0
            },
            "2": {
                "precision": 0.7261447046487243,
                "recall": 0.8112065599375244,
                "f1-score": 0.7663223902618961,
                "support": 5122.0
            },
            "3": {
                "precision": 0.9496764917325665,
                "recall": 0.7671312427409989,
                "f1-score": 0.848699004176036,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9931818181818182,
                "recall": 0.9971477467199087,
                "f1-score": 0.9951608311984059,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9909638554216867,
                "recall": 0.9819809860711917,
                "f1-score": 0.9864519711271514,
                "support": 9046.0
            },
            "6": {
                "precision": 0.9115138592750534,
                "recall": 0.9411117226197028,
                "f1-score": 0.9260763606823721,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9779156780434386,
                "recall": 0.9891083625623038,
                "f1-score": 0.9834801762114538,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9521752545510644,
                "recall": 0.9731945758435825,
                "f1-score": 0.9625701809107922,
                "support": 3171.0
            },
            "accuracy": 0.9162394889017954,
            "macro avg": {
                "precision": 0.9299228341033577,
                "recall": 0.9119794724697091,
                "f1-score": 0.91926137346401,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.9194014095356233,
                "recall": 0.9162394889017954,
                "f1-score": 0.9169462966461276,
                "support": 39601.0
            },
            "cross-entropy": 0.22037795763104842,
            "score": 0.9162394889017954
        },
        "val": {
            "0": {
                "precision": 0.6861924686192469,
                "recall": 0.5324675324675324,
                "f1-score": 0.59963436928702,
                "support": 308.0
            },
            "1": {
                "precision": 0.7866242038216561,
                "recall": 0.765891472868217,
                "f1-score": 0.7761194029850746,
                "support": 2580.0
            },
            "2": {
                "precision": 0.5776271186440678,
                "recall": 0.6651053864168618,
                "f1-score": 0.618287373004354,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7350157728706624,
                "recall": 0.5406032482598608,
                "f1-score": 0.622994652406417,
                "support": 431.0
            },
            "4": {
                "precision": 0.963718820861678,
                "recall": 0.9703196347031964,
                "f1-score": 0.9670079635949943,
                "support": 438.0
            },
            "5": {
                "precision": 0.9486717694732103,
                "recall": 0.9314765694076039,
                "f1-score": 0.9399955387017622,
                "support": 2262.0
            },
            "6": {
                "precision": 0.6995798319327731,
                "recall": 0.7334801762114538,
                "f1-score": 0.7161290322580645,
                "support": 454.0
            },
            "7": {
                "precision": 0.9002123142250531,
                "recall": 0.9394387001477105,
                "f1-score": 0.919407300325262,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8649318463444857,
                "recall": 0.880201765447667,
                "f1-score": 0.8724999999999999,
                "support": 793.0
            },
            "accuracy": 0.8140591859408141,
            "macro avg": {
                "precision": 0.7958415718658703,
                "recall": 0.7732204984366783,
                "f1-score": 0.7813417369514387,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8168833371053532,
                "recall": 0.8140591859408141,
                "f1-score": 0.813990932969518,
                "support": 9901.0
            },
            "cross-entropy": 0.5924137023784514,
            "score": 0.8140591859408141
        },
        "test": {
            "0": {
                "precision": 0.6655518394648829,
                "recall": 0.5155440414507773,
                "f1-score": 0.581021897810219,
                "support": 386.0
            },
            "1": {
                "precision": 0.7877524847707599,
                "recall": 0.7620967741935484,
                "f1-score": 0.7747122812549266,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5597554196775987,
                "recall": 0.6289818863210493,
                "f1-score": 0.5923529411764706,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6945107398568019,
                "recall": 0.5408921933085502,
                "f1-score": 0.6081504702194357,
                "support": 538.0
            },
            "4": {
                "precision": 0.9676258992805755,
                "recall": 0.9817518248175182,
                "f1-score": 0.9746376811594203,
                "support": 548.0
            },
            "5": {
                "precision": 0.9446612273855978,
                "recall": 0.9419879731163778,
                "f1-score": 0.9433227063407722,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7056798623063684,
                "recall": 0.721830985915493,
                "f1-score": 0.7136640557006092,
                "support": 568.0
            },
            "7": {
                "precision": 0.9031700288184438,
                "recall": 0.9255759007678677,
                "f1-score": 0.9142357059509918,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8493803622497617,
                "recall": 0.8990918264379415,
                "f1-score": 0.8735294117647059,
                "support": 991.0
            },
            "accuracy": 0.8098739495798319,
            "macro avg": {
                "precision": 0.7864542070900878,
                "recall": 0.7686392673699026,
                "f1-score": 0.7750696834863946,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8111568736324473,
                "recall": 0.8098739495798319,
                "f1-score": 0.809404773763311,
                "support": 12376.0
            },
            "cross-entropy": 0.5959683757894841,
            "score": 0.8098739495798319
        }
    },
    "time": "0:01:06.219722",
    "chunk_size": null,
    "eval_batch_size": 32768
}