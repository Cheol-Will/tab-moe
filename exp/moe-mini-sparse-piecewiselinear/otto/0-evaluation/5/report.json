{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 5,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0003132327132740685,
            "weight_decay": 0.0
        },
        "model": {
            "arch_type": "moe-sparse",
            "backbone": {
                "k": 2,
                "n_blocks": 2,
                "d_block": 800,
                "dropout": 0.4702683300894907,
                "moe_ratio": 0.25,
                "num_experts": 28
            },
            "num_embeddings": {
                "type": "PiecewiseLinearEmbeddingsV2",
                "d_embedding": 28
            }
        },
        "bins": {
            "n_bins": 54
        }
    },
    "n_parameters": 20092465,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 858,
    "metrics": {
        "val": {
            "0": {
                "precision": 0.6180904522613065,
                "recall": 0.39935064935064934,
                "f1-score": 0.4852071005917159,
                "support": 308.0
            },
            "1": {
                "precision": 0.7151374627360053,
                "recall": 0.8368217054263566,
                "f1-score": 0.7712091444900876,
                "support": 2580.0
            },
            "2": {
                "precision": 0.5817860300618921,
                "recall": 0.5136612021857924,
                "f1-score": 0.5456053067993366,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7478632478632479,
                "recall": 0.4060324825986079,
                "f1-score": 0.5263157894736843,
                "support": 431.0
            },
            "4": {
                "precision": 0.9788235294117648,
                "recall": 0.9497716894977168,
                "f1-score": 0.9640787949015064,
                "support": 438.0
            },
            "5": {
                "precision": 0.9383715699505173,
                "recall": 0.9221927497789567,
                "f1-score": 0.9302118171683389,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7161458333333334,
                "recall": 0.6057268722466961,
                "f1-score": 0.6563245823389022,
                "support": 454.0
            },
            "7": {
                "precision": 0.868567454798331,
                "recall": 0.9224519940915805,
                "f1-score": 0.8946991404011462,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8066037735849056,
                "recall": 0.862547288776797,
                "f1-score": 0.8336380255941498,
                "support": 793.0
            },
            "accuracy": 0.7903242096757903,
            "macro avg": {
                "precision": 0.774598817111256,
                "recall": 0.7131729593281282,
                "f1-score": 0.7341433001954297,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.7873095656183463,
                "recall": 0.7903242096757903,
                "f1-score": 0.7839410641776183,
                "support": 9901.0
            },
            "cross-entropy": 0.5700169716338644,
            "score": 0.7903242096757903
        },
        "test": {
            "0": {
                "precision": 0.6473029045643154,
                "recall": 0.40414507772020725,
                "f1-score": 0.4976076555023924,
                "support": 386.0
            },
            "1": {
                "precision": 0.7124933262146289,
                "recall": 0.8278535980148883,
                "f1-score": 0.7658536585365853,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5518731988472623,
                "recall": 0.47845096814490945,
                "f1-score": 0.5125460020073603,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6993670886075949,
                "recall": 0.4107806691449814,
                "f1-score": 0.5175644028103045,
                "support": 538.0
            },
            "4": {
                "precision": 0.9794007490636704,
                "recall": 0.9543795620437956,
                "f1-score": 0.9667282809611829,
                "support": 548.0
            },
            "5": {
                "precision": 0.9431245500359972,
                "recall": 0.9267775026529891,
                "f1-score": 0.9348795718108832,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7286324786324786,
                "recall": 0.6003521126760564,
                "f1-score": 0.6583011583011583,
                "support": 568.0
            },
            "7": {
                "precision": 0.8608360836083608,
                "recall": 0.9243945658594211,
                "f1-score": 0.8914839077185986,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8077276908923643,
                "recall": 0.8859737638748738,
                "f1-score": 0.8450433108758422,
                "support": 991.0
            },
            "accuracy": 0.7869263089851325,
            "macro avg": {
                "precision": 0.7700842300518524,
                "recall": 0.7125675355702358,
                "f1-score": 0.7322231053915897,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.7822711281858705,
                "recall": 0.7869263089851325,
                "f1-score": 0.7800203159589771,
                "support": 12376.0
            },
            "cross-entropy": 0.5600438873774225,
            "score": 0.7869263089851325
        }
    }
}