{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 10,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0001019287055215591,
            "weight_decay": 0.0006971737495410442
        },
        "model": {
            "arch_type": "moe-sparse",
            "backbone": {
                "k": 6,
                "n_blocks": 1,
                "d_block": 592,
                "dropout": 0.43638325397216426,
                "moe_ratio": 0.25,
                "num_experts": 48
            }
        }
    },
    "n_parameters": 8500537,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 3666,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.8815298507462687,
                "recall": 0.7651821862348178,
                "f1-score": 0.8192457737321196,
                "support": 1235.0
            },
            "1": {
                "precision": 0.7887055837563451,
                "recall": 0.8432835820895522,
                "f1-score": 0.8150819672131147,
                "support": 10318.0
            },
            "2": {
                "precision": 0.6404382470119522,
                "recall": 0.6276844982428739,
                "f1-score": 0.633997239203313,
                "support": 5122.0
            },
            "3": {
                "precision": 0.7873831775700935,
                "recall": 0.5871080139372822,
                "f1-score": 0.6726546906187624,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9844738355376653,
                "recall": 0.9766115231032516,
                "f1-score": 0.9805269186712486,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9741742407448459,
                "recall": 0.9715896528852531,
                "f1-score": 0.9728802302413105,
                "support": 9046.0
            },
            "6": {
                "precision": 0.8449048152295633,
                "recall": 0.8304898183819482,
                "f1-score": 0.8376353039134056,
                "support": 1817.0
            },
            "7": {
                "precision": 0.959375,
                "recall": 0.9634484031751892,
                "f1-score": 0.9614073869393018,
                "support": 5417.0
            },
            "8": {
                "precision": 0.922333125389894,
                "recall": 0.9325134027120782,
                "f1-score": 0.927395326956249,
                "support": 3171.0
            },
            "accuracy": 0.8600287871518396,
            "macro avg": {
                "precision": 0.8648130973318475,
                "recall": 0.8331012311958051,
                "f1-score": 0.8467583152765362,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.8600227189262747,
                "recall": 0.8600287871518396,
                "f1-score": 0.8590102648908278,
                "support": 39601.0
            },
            "cross-entropy": 0.34398536369574234,
            "score": 0.8600287871518396
        },
        "val": {
            "0": {
                "precision": 0.6340425531914894,
                "recall": 0.4837662337662338,
                "f1-score": 0.5488029465930019,
                "support": 308.0
            },
            "1": {
                "precision": 0.7528860028860029,
                "recall": 0.8089147286821705,
                "f1-score": 0.7798953662182362,
                "support": 2580.0
            },
            "2": {
                "precision": 0.5943775100401606,
                "recall": 0.5776736924277908,
                "f1-score": 0.5859065716547901,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7080745341614907,
                "recall": 0.5290023201856149,
                "f1-score": 0.6055776892430279,
                "support": 431.0
            },
            "4": {
                "precision": 0.965675057208238,
                "recall": 0.9634703196347032,
                "f1-score": 0.9645714285714286,
                "support": 438.0
            },
            "5": {
                "precision": 0.9446675591253905,
                "recall": 0.9358974358974359,
                "f1-score": 0.9402620475238729,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7256235827664399,
                "recall": 0.7048458149779736,
                "f1-score": 0.7150837988826816,
                "support": 454.0
            },
            "7": {
                "precision": 0.9120639534883721,
                "recall": 0.9268833087149188,
                "f1-score": 0.9194139194139195,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8329326923076923,
                "recall": 0.8738965952080706,
                "f1-score": 0.8529230769230769,
                "support": 793.0
            },
            "accuracy": 0.8091101908898091,
            "macro avg": {
                "precision": 0.7855937161305863,
                "recall": 0.756038938832768,
                "f1-score": 0.7680485383360038,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.806887761520248,
                "recall": 0.8091101908898091,
                "f1-score": 0.8067840807534284,
                "support": 9901.0
            },
            "cross-entropy": 0.5352279811905881,
            "score": 0.8091101908898091
        },
        "test": {
            "0": {
                "precision": 0.6527331189710611,
                "recall": 0.5259067357512953,
                "f1-score": 0.5824964131994261,
                "support": 386.0
            },
            "1": {
                "precision": 0.7555878084179971,
                "recall": 0.8073821339950372,
                "f1-score": 0.7806267806267806,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5771725032425421,
                "recall": 0.5559025608994379,
                "f1-score": 0.5663378937321031,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6928571428571428,
                "recall": 0.5408921933085502,
                "f1-score": 0.6075156576200418,
                "support": 538.0
            },
            "4": {
                "precision": 0.9724770642201835,
                "recall": 0.9671532846715328,
                "f1-score": 0.9698078682525161,
                "support": 548.0
            },
            "5": {
                "precision": 0.9482269503546099,
                "recall": 0.9458790237000354,
                "f1-score": 0.9470515317867895,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7513812154696132,
                "recall": 0.7183098591549296,
                "f1-score": 0.7344734473447344,
                "support": 568.0
            },
            "7": {
                "precision": 0.9070718877849211,
                "recall": 0.9167158889545186,
                "f1-score": 0.9118683901292597,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8411934552454283,
                "recall": 0.8819374369323916,
                "f1-score": 0.8610837438423646,
                "support": 991.0
            },
            "accuracy": 0.8100355526826115,
            "macro avg": {
                "precision": 0.7887445718403889,
                "recall": 0.7622310130408587,
                "f1-score": 0.7734735251704462,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8075642670661667,
                "recall": 0.8100355526826115,
                "f1-score": 0.8078710595339739,
                "support": 12376.0
            },
            "cross-entropy": 0.5276204752901265,
            "score": 0.8100355526826115
        }
    },
    "time": "0:00:50.977773",
    "chunk_size": null,
    "eval_batch_size": 32768
}