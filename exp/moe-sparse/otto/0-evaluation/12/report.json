{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 12,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0001019287055215591,
            "weight_decay": 0.0006971737495410442
        },
        "model": {
            "arch_type": "moe-sparse",
            "backbone": {
                "k": 6,
                "n_blocks": 1,
                "d_block": 592,
                "dropout": 0.43638325397216426,
                "moe_ratio": 0.25,
                "num_experts": 48
            }
        }
    },
    "n_parameters": 8500537,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 5070,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9052173913043479,
                "recall": 0.8429149797570851,
                "f1-score": 0.8729559748427673,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8023598820058997,
                "recall": 0.8962977321186276,
                "f1-score": 0.8467313678813404,
                "support": 10318.0
            },
            "2": {
                "precision": 0.7301161751563896,
                "recall": 0.6380320187426787,
                "f1-score": 0.6809752031673266,
                "support": 5122.0
            },
            "3": {
                "precision": 0.860573199070488,
                "recall": 0.6451800232288037,
                "f1-score": 0.7374709591769002,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9834190966266438,
                "recall": 0.9811751283513976,
                "f1-score": 0.9822958309537407,
                "support": 1753.0
            },
            "5": {
                "precision": 0.980134642975389,
                "recall": 0.9817598938757461,
                "f1-score": 0.9809465952394101,
                "support": 9046.0
            },
            "6": {
                "precision": 0.8923512747875354,
                "recall": 0.8668134287286736,
                "f1-score": 0.8793969849246231,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9740836727138097,
                "recall": 0.9713863762230016,
                "f1-score": 0.9727331546353636,
                "support": 5417.0
            },
            "8": {
                "precision": 0.949701351776171,
                "recall": 0.9526963103122044,
                "f1-score": 0.9511964735516372,
                "support": 3171.0
            },
            "accuracy": 0.8870230549733592,
            "macro avg": {
                "precision": 0.8975507429351859,
                "recall": 0.8640284323709131,
                "f1-score": 0.8783002827081233,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.8867958638254569,
                "recall": 0.8870230549733592,
                "f1-score": 0.8851182090137576,
                "support": 39601.0
            },
            "cross-entropy": 0.28196336466479266,
            "score": 0.8870230549733592
        },
        "val": {
            "0": {
                "precision": 0.6423357664233577,
                "recall": 0.5714285714285714,
                "f1-score": 0.604810996563574,
                "support": 308.0
            },
            "1": {
                "precision": 0.7446735395189004,
                "recall": 0.8399224806201551,
                "f1-score": 0.7894353369763206,
                "support": 2580.0
            },
            "2": {
                "precision": 0.6207207207207207,
                "recall": 0.5378610460577674,
                "f1-score": 0.5763278962777081,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7202572347266881,
                "recall": 0.5197215777262181,
                "f1-score": 0.6037735849056605,
                "support": 431.0
            },
            "4": {
                "precision": 0.9813084112149533,
                "recall": 0.958904109589041,
                "f1-score": 0.9699769053117782,
                "support": 438.0
            },
            "5": {
                "precision": 0.945064761054042,
                "recall": 0.9354553492484527,
                "f1-score": 0.9402355032215063,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7410714285714286,
                "recall": 0.7312775330396476,
                "f1-score": 0.7361419068736141,
                "support": 454.0
            },
            "7": {
                "precision": 0.9111600587371512,
                "recall": 0.9165435745937962,
                "f1-score": 0.9138438880706923,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8437118437118437,
                "recall": 0.8713745271122321,
                "f1-score": 0.8573200992555831,
                "support": 793.0
            },
            "accuracy": 0.8136551863448137,
            "macro avg": {
                "precision": 0.7944781960754539,
                "recall": 0.7647209743795425,
                "f1-score": 0.7768740130507152,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8111747776193332,
                "recall": 0.8136551863448137,
                "f1-score": 0.8104835762305013,
                "support": 9901.0
            },
            "cross-entropy": 0.5649973251618865,
            "score": 0.8136551863448137
        },
        "test": {
            "0": {
                "precision": 0.6482558139534884,
                "recall": 0.5777202072538861,
                "f1-score": 0.6109589041095891,
                "support": 386.0
            },
            "1": {
                "precision": 0.7457907811206183,
                "recall": 0.8380893300248139,
                "f1-score": 0.7892507667591645,
                "support": 3224.0
            },
            "2": {
                "precision": 0.6014760147601476,
                "recall": 0.5090568394753279,
                "f1-score": 0.5514208389715832,
                "support": 1601.0
            },
            "3": {
                "precision": 0.676056338028169,
                "recall": 0.5353159851301115,
                "f1-score": 0.5975103734439834,
                "support": 538.0
            },
            "4": {
                "precision": 0.9759704251386322,
                "recall": 0.9635036496350365,
                "f1-score": 0.9696969696969697,
                "support": 548.0
            },
            "5": {
                "precision": 0.946232755571277,
                "recall": 0.946232755571277,
                "f1-score": 0.946232755571277,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7207207207207207,
                "recall": 0.704225352112676,
                "f1-score": 0.7123775601068565,
                "support": 568.0
            },
            "7": {
                "precision": 0.9201430274135876,
                "recall": 0.9119905493207324,
                "f1-score": 0.9160486502521505,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8461538461538461,
                "recall": 0.8768920282542886,
                "f1-score": 0.8612487611496531,
                "support": 991.0
            },
            "accuracy": 0.8115707821590175,
            "macro avg": {
                "precision": 0.7867555247622763,
                "recall": 0.7625585218642388,
                "f1-score": 0.7727495088956918,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8077633646819712,
                "recall": 0.8115707821590175,
                "f1-score": 0.8080197344727735,
                "support": 12376.0
            },
            "cross-entropy": 0.5522820590076231,
            "score": 0.8115707821590175
        }
    },
    "time": "0:01:04.929829",
    "chunk_size": null,
    "eval_batch_size": 32768
}