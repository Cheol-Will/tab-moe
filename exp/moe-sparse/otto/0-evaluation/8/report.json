{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 8,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0001019287055215591,
            "weight_decay": 0.0006971737495410442
        },
        "model": {
            "arch_type": "moe-sparse",
            "backbone": {
                "k": 6,
                "n_blocks": 1,
                "d_block": 592,
                "dropout": 0.43638325397216426,
                "moe_ratio": 0.25,
                "num_experts": 48
            }
        }
    },
    "n_parameters": 8500537,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 4680,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.886443661971831,
                "recall": 0.8153846153846154,
                "f1-score": 0.8494306199915648,
                "support": 1235.0
            },
            "1": {
                "precision": 0.7986901068597035,
                "recall": 0.898236092265943,
                "f1-score": 0.845543289845817,
                "support": 10318.0
            },
            "2": {
                "precision": 0.7371735074626866,
                "recall": 0.6171417415072238,
                "f1-score": 0.6718384697130713,
                "support": 5122.0
            },
            "3": {
                "precision": 0.8286334056399133,
                "recall": 0.6655052264808362,
                "f1-score": 0.7381642512077294,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9879240943070731,
                "recall": 0.980034227039361,
                "f1-score": 0.983963344788087,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9810798849302943,
                "recall": 0.9802122485076277,
                "f1-score": 0.9806458748064587,
                "support": 9046.0
            },
            "6": {
                "precision": 0.872093023255814,
                "recall": 0.8668134287286736,
                "f1-score": 0.8694452111509798,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9725396240324364,
                "recall": 0.9741554365885177,
                "f1-score": 0.9733468597251683,
                "support": 5417.0
            },
            "8": {
                "precision": 0.944985853505187,
                "recall": 0.9479659413434248,
                "f1-score": 0.9464735516372796,
                "support": 3171.0
            },
            "accuracy": 0.8844473624403424,
            "macro avg": {
                "precision": 0.8899514624405488,
                "recall": 0.8606054397606915,
                "f1-score": 0.8732057192073507,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.8836752041451897,
                "recall": 0.8844473624403424,
                "f1-score": 0.8821776674759705,
                "support": 39601.0
            },
            "cross-entropy": 0.29043879453815213,
            "score": 0.8844473624403424
        },
        "val": {
            "0": {
                "precision": 0.6296296296296297,
                "recall": 0.4967532467532468,
                "f1-score": 0.5553539019963702,
                "support": 308.0
            },
            "1": {
                "precision": 0.7415152553993829,
                "recall": 0.8383720930232558,
                "f1-score": 0.78697471348008,
                "support": 2580.0
            },
            "2": {
                "precision": 0.6132339235787512,
                "recall": 0.5136612021857924,
                "f1-score": 0.5590484282073067,
                "support": 1281.0
            },
            "3": {
                "precision": 0.6864406779661016,
                "recall": 0.5638051044083526,
                "f1-score": 0.6191082802547772,
                "support": 431.0
            },
            "4": {
                "precision": 0.985781990521327,
                "recall": 0.9497716894977168,
                "f1-score": 0.9674418604651162,
                "support": 438.0
            },
            "5": {
                "precision": 0.9436997319034852,
                "recall": 0.9336870026525199,
                "f1-score": 0.9386666666666666,
                "support": 2262.0
            },
            "6": {
                "precision": 0.734375,
                "recall": 0.724669603524229,
                "f1-score": 0.729490022172949,
                "support": 454.0
            },
            "7": {
                "precision": 0.902072909220872,
                "recall": 0.9320531757754801,
                "f1-score": 0.9168180167090447,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8537794299876085,
                "recall": 0.8688524590163934,
                "f1-score": 0.8612500000000001,
                "support": 793.0
            },
            "accuracy": 0.8105241894758105,
            "macro avg": {
                "precision": 0.7878365053563509,
                "recall": 0.7579583974263318,
                "f1-score": 0.7704613211058123,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8066584421415375,
                "recall": 0.8105241894758105,
                "f1-score": 0.806681680384925,
                "support": 9901.0
            },
            "cross-entropy": 0.5614203506087153,
            "score": 0.8105241894758105
        },
        "test": {
            "0": {
                "precision": 0.6369230769230769,
                "recall": 0.5362694300518135,
                "f1-score": 0.5822784810126582,
                "support": 386.0
            },
            "1": {
                "precision": 0.7485572959604286,
                "recall": 0.8449131513647643,
                "f1-score": 0.7938219437563748,
                "support": 3224.0
            },
            "2": {
                "precision": 0.6203773584905661,
                "recall": 0.5134291068082448,
                "f1-score": 0.5618591934381408,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6651376146788991,
                "recall": 0.5390334572490706,
                "f1-score": 0.595482546201232,
                "support": 538.0
            },
            "4": {
                "precision": 0.983177570093458,
                "recall": 0.9598540145985401,
                "f1-score": 0.9713758079409048,
                "support": 548.0
            },
            "5": {
                "precision": 0.9378074490513001,
                "recall": 0.9441103643438273,
                "f1-score": 0.9409483518420589,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7486338797814208,
                "recall": 0.7235915492957746,
                "f1-score": 0.7358997314234558,
                "support": 568.0
            },
            "7": {
                "precision": 0.9072769953051644,
                "recall": 0.9131718842291789,
                "f1-score": 0.9102148954960259,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8534906588003933,
                "recall": 0.875882946518668,
                "f1-score": 0.8645418326693227,
                "support": 991.0
            },
            "accuracy": 0.8131060116354234,
            "macro avg": {
                "precision": 0.7890424332316343,
                "recall": 0.7611395449399869,
                "f1-score": 0.7729358648644638,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8086041874618047,
                "recall": 0.8131060116354234,
                "f1-score": 0.8089906572398089,
                "support": 12376.0
            },
            "cross-entropy": 0.5655950018600875,
            "score": 0.8131060116354234
        }
    },
    "time": "0:01:00.529651",
    "chunk_size": null,
    "eval_batch_size": 32768
}