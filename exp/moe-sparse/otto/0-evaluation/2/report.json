{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 2,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0001019287055215591,
            "weight_decay": 0.0006971737495410442
        },
        "model": {
            "arch_type": "moe-sparse",
            "backbone": {
                "k": 6,
                "n_blocks": 1,
                "d_block": 592,
                "dropout": 0.43638325397216426,
                "moe_ratio": 0.25,
                "num_experts": 48
            }
        }
    },
    "n_parameters": 8500537,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 7800,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9761295822676896,
                "recall": 0.9271255060728745,
                "f1-score": 0.9509966777408637,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8558614564831261,
                "recall": 0.9339988369839116,
                "f1-score": 0.8932245805913429,
                "support": 10318.0
            },
            "2": {
                "precision": 0.8250327653997379,
                "recall": 0.7374072627879734,
                "f1-score": 0.7787628865979381,
                "support": 5122.0
            },
            "3": {
                "precision": 0.9172413793103448,
                "recall": 0.7723577235772358,
                "f1-score": 0.8385876418663304,
                "support": 1722.0
            },
            "4": {
                "precision": 0.992579908675799,
                "recall": 0.9920136908157444,
                "f1-score": 0.9922967189728958,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9960026648900733,
                "recall": 0.991598496573071,
                "f1-score": 0.9937957013073343,
                "support": 9046.0
            },
            "6": {
                "precision": 0.9585462805224304,
                "recall": 0.9290038525041276,
                "f1-score": 0.9435438792621575,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9876497695852534,
                "recall": 0.9891083625623038,
                "f1-score": 0.9883785279468733,
                "support": 5417.0
            },
            "8": {
                "precision": 0.973404255319149,
                "recall": 0.9810785241248817,
                "f1-score": 0.9772263232291503,
                "support": 3171.0
            },
            "accuracy": 0.9281331279513143,
            "macro avg": {
                "precision": 0.9424942291615115,
                "recall": 0.9170769173335694,
                "f1-score": 0.9285347708349874,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.9285089011721229,
                "recall": 0.9281331279513143,
                "f1-score": 0.9272560286824252,
                "support": 39601.0
            },
            "cross-entropy": 0.18876244920003546,
            "score": 0.9281331279513143
        },
        "val": {
            "0": {
                "precision": 0.6090225563909775,
                "recall": 0.525974025974026,
                "f1-score": 0.5644599303135889,
                "support": 308.0
            },
            "1": {
                "precision": 0.7513908205841446,
                "recall": 0.8375968992248062,
                "f1-score": 0.7921554252199413,
                "support": 2580.0
            },
            "2": {
                "precision": 0.6195840554592721,
                "recall": 0.5581576893052302,
                "f1-score": 0.5872689938398358,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7648902821316614,
                "recall": 0.5661252900232019,
                "f1-score": 0.6506666666666667,
                "support": 431.0
            },
            "4": {
                "precision": 0.976905311778291,
                "recall": 0.9657534246575342,
                "f1-score": 0.9712973593570609,
                "support": 438.0
            },
            "5": {
                "precision": 0.9468228931951329,
                "recall": 0.9288240495137047,
                "f1-score": 0.9377371122517295,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7282850779510023,
                "recall": 0.7202643171806168,
                "f1-score": 0.7242524916943522,
                "support": 454.0
            },
            "7": {
                "precision": 0.911530094271211,
                "recall": 0.9283604135893648,
                "f1-score": 0.9198682766190999,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8498759305210918,
                "recall": 0.8638083228247163,
                "f1-score": 0.8567854909318323,
                "support": 793.0
            },
            "accuracy": 0.8155741844258155,
            "macro avg": {
                "precision": 0.7953674469203095,
                "recall": 0.7660960480325778,
                "f1-score": 0.7782768607660119,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8138495958004313,
                "recall": 0.8155741844258155,
                "f1-score": 0.813117496559786,
                "support": 9901.0
            },
            "cross-entropy": 0.6621944258243408,
            "score": 0.8155741844258155
        },
        "test": {
            "0": {
                "precision": 0.6392961876832844,
                "recall": 0.5647668393782384,
                "f1-score": 0.5997248968363136,
                "support": 386.0
            },
            "1": {
                "precision": 0.753725049198763,
                "recall": 0.831575682382134,
                "f1-score": 0.7907388290812566,
                "support": 3224.0
            },
            "2": {
                "precision": 0.6082621082621082,
                "recall": 0.5334166146158651,
                "f1-score": 0.5683860232945092,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6824324324324325,
                "recall": 0.5631970260223048,
                "f1-score": 0.6171079429735234,
                "support": 538.0
            },
            "4": {
                "precision": 0.9762340036563071,
                "recall": 0.9744525547445255,
                "f1-score": 0.9753424657534246,
                "support": 548.0
            },
            "5": {
                "precision": 0.9479315263908702,
                "recall": 0.9402193137601698,
                "f1-score": 0.9440596696856687,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7259528130671506,
                "recall": 0.704225352112676,
                "f1-score": 0.7149240393208222,
                "support": 568.0
            },
            "7": {
                "precision": 0.9068684516880093,
                "recall": 0.9202598936798583,
                "f1-score": 0.9135150982116681,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8623762376237624,
                "recall": 0.8789101917255298,
                "f1-score": 0.8705647176411793,
                "support": 991.0
            },
            "accuracy": 0.8142372333548804,
            "macro avg": {
                "precision": 0.7892309788891876,
                "recall": 0.7678914964912558,
                "f1-score": 0.7771515203109296,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8108287951005639,
                "recall": 0.8142372333548804,
                "f1-score": 0.811373448608137,
                "support": 12376.0
            },
            "cross-entropy": 0.647672090909764,
            "score": 0.8142372333548804
        }
    },
    "time": "0:01:30.141894",
    "chunk_size": null,
    "eval_batch_size": 32768
}