{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 4,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0001019287055215591,
            "weight_decay": 0.0006971737495410442
        },
        "model": {
            "arch_type": "moe-sparse",
            "backbone": {
                "k": 6,
                "n_blocks": 1,
                "d_block": 592,
                "dropout": 0.43638325397216426,
                "moe_ratio": 0.25,
                "num_experts": 48
            }
        }
    },
    "n_parameters": 8500537,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 3744,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.8862781954887218,
                "recall": 0.7635627530364373,
                "f1-score": 0.8203566768160069,
                "support": 1235.0
            },
            "1": {
                "precision": 0.7675497806277422,
                "recall": 0.8816631130063965,
                "f1-score": 0.8206585475868291,
                "support": 10318.0
            },
            "2": {
                "precision": 0.687206020696143,
                "recall": 0.5704802811401796,
                "f1-score": 0.6234264988265414,
                "support": 5122.0
            },
            "3": {
                "precision": 0.8128119800332779,
                "recall": 0.5673635307781649,
                "f1-score": 0.6682626538987688,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9828178694158075,
                "recall": 0.9788933257273246,
                "f1-score": 0.9808516719062589,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9699173553719008,
                "recall": 0.9730267521556489,
                "f1-score": 0.9714695656972574,
                "support": 9046.0
            },
            "6": {
                "precision": 0.8475540386803185,
                "recall": 0.8200330214639515,
                "f1-score": 0.8335664335664335,
                "support": 1817.0
            },
            "7": {
                "precision": 0.95923962712484,
                "recall": 0.9688019198818534,
                "f1-score": 0.9639970609845702,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9261238604212512,
                "recall": 0.9290444654683065,
                "f1-score": 0.9275818639798488,
                "support": 3171.0
            },
            "accuracy": 0.8621246938208631,
            "macro avg": {
                "precision": 0.8710554142066669,
                "recall": 0.8280965736286959,
                "f1-score": 0.8455745525847239,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.8611742457807094,
                "recall": 0.8621246938208631,
                "f1-score": 0.8588143041550639,
                "support": 39601.0
            },
            "cross-entropy": 0.3419813479357826,
            "score": 0.8621246938208631
        },
        "val": {
            "0": {
                "precision": 0.6570247933884298,
                "recall": 0.5162337662337663,
                "f1-score": 0.5781818181818182,
                "support": 308.0
            },
            "1": {
                "precision": 0.7363083164300203,
                "recall": 0.8441860465116279,
                "f1-score": 0.7865655471289273,
                "support": 2580.0
            },
            "2": {
                "precision": 0.6385767790262172,
                "recall": 0.5323965651834505,
                "f1-score": 0.5806726266496381,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7006172839506173,
                "recall": 0.5266821345707656,
                "f1-score": 0.6013245033112583,
                "support": 431.0
            },
            "4": {
                "precision": 0.9744186046511628,
                "recall": 0.95662100456621,
                "f1-score": 0.9654377880184333,
                "support": 438.0
            },
            "5": {
                "precision": 0.9493727598566308,
                "recall": 0.9367816091954023,
                "f1-score": 0.943035157988429,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7416481069042317,
                "recall": 0.7334801762114538,
                "f1-score": 0.7375415282392027,
                "support": 454.0
            },
            "7": {
                "precision": 0.898932384341637,
                "recall": 0.9327917282127031,
                "f1-score": 0.9155491119971005,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8575031525851198,
                "recall": 0.8575031525851198,
                "f1-score": 0.8575031525851198,
                "support": 793.0
            },
            "accuracy": 0.8140591859408141,
            "macro avg": {
                "precision": 0.794933575681563,
                "recall": 0.7596306870300554,
                "f1-score": 0.773979026011103,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8110454718346022,
                "recall": 0.8140591859408141,
                "f1-score": 0.810113749847949,
                "support": 9901.0
            },
            "cross-entropy": 0.5364257117933663,
            "score": 0.8140591859408141
        },
        "test": {
            "0": {
                "precision": 0.6750902527075813,
                "recall": 0.4844559585492228,
                "f1-score": 0.5641025641025642,
                "support": 386.0
            },
            "1": {
                "precision": 0.7318450779989242,
                "recall": 0.8439826302729528,
                "f1-score": 0.783923941227312,
                "support": 3224.0
            },
            "2": {
                "precision": 0.6072530864197531,
                "recall": 0.4915677701436602,
                "f1-score": 0.5433206765619607,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6717171717171717,
                "recall": 0.4944237918215613,
                "f1-score": 0.569593147751606,
                "support": 538.0
            },
            "4": {
                "precision": 0.9779005524861878,
                "recall": 0.968978102189781,
                "f1-score": 0.9734188817598532,
                "support": 548.0
            },
            "5": {
                "precision": 0.9479646017699115,
                "recall": 0.9472939511850018,
                "f1-score": 0.9476291578202406,
                "support": 2827.0
            },
            "6": {
                "precision": 0.705244122965642,
                "recall": 0.6866197183098591,
                "f1-score": 0.695807314897413,
                "support": 568.0
            },
            "7": {
                "precision": 0.9005747126436782,
                "recall": 0.9255759007678677,
                "f1-score": 0.9129041654529566,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8511673151750972,
                "recall": 0.8829465186680121,
                "f1-score": 0.8667657256067359,
                "support": 991.0
            },
            "accuracy": 0.8081771170006464,
            "macro avg": {
                "precision": 0.7854174326537718,
                "recall": 0.7473160379897688,
                "f1-score": 0.7619406194645157,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8030214358767166,
                "recall": 0.8081771170006464,
                "f1-score": 0.8026440861618124,
                "support": 12376.0
            },
            "cross-entropy": 0.5315200102061581,
            "score": 0.8081771170006464
        }
    },
    "time": "0:00:50.685680",
    "chunk_size": null,
    "eval_batch_size": 32768
}