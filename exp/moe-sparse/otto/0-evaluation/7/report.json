{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 7,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0001019287055215591,
            "weight_decay": 0.0006971737495410442
        },
        "model": {
            "arch_type": "moe-sparse",
            "backbone": {
                "k": 6,
                "n_blocks": 1,
                "d_block": 592,
                "dropout": 0.43638325397216426,
                "moe_ratio": 0.25,
                "num_experts": 48
            }
        }
    },
    "n_parameters": 8500537,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 3354,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.8541458541458542,
                "recall": 0.6923076923076923,
                "f1-score": 0.7647584973166368,
                "support": 1235.0
            },
            "1": {
                "precision": 0.7795746176832484,
                "recall": 0.8596627253343672,
                "f1-score": 0.8176622418879056,
                "support": 10318.0
            },
            "2": {
                "precision": 0.6634104905500107,
                "recall": 0.6099180007809449,
                "f1-score": 0.6355406367612654,
                "support": 5122.0
            },
            "3": {
                "precision": 0.8077858880778589,
                "recall": 0.578397212543554,
                "f1-score": 0.6741116751269035,
                "support": 1722.0
            },
            "4": {
                "precision": 0.975470621791215,
                "recall": 0.975470621791215,
                "f1-score": 0.975470621791215,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9647266313932981,
                "recall": 0.9674994472695114,
                "f1-score": 0.9661110497847445,
                "support": 9046.0
            },
            "6": {
                "precision": 0.8299086757990868,
                "recall": 0.8002201430930105,
                "f1-score": 0.8147940599607734,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9465957056340613,
                "recall": 0.9521875576887576,
                "f1-score": 0.9493833977544633,
                "support": 5417.0
            },
            "8": {
                "precision": 0.8995082974800246,
                "recall": 0.9230526647745191,
                "f1-score": 0.9111284046692607,
                "support": 3171.0
            },
            "accuracy": 0.8546753869851771,
            "macro avg": {
                "precision": 0.8579029758394064,
                "recall": 0.8176351183981746,
                "f1-score": 0.8343289538947964,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.8538276252426124,
                "recall": 0.8546753869851771,
                "f1-score": 0.8524808616496772,
                "support": 39601.0
            },
            "cross-entropy": 0.36106048601062096,
            "score": 0.8546753869851771
        },
        "val": {
            "0": {
                "precision": 0.6709401709401709,
                "recall": 0.5097402597402597,
                "f1-score": 0.5793357933579335,
                "support": 308.0
            },
            "1": {
                "precision": 0.7487753673897831,
                "recall": 0.8294573643410853,
                "f1-score": 0.7870540639941156,
                "support": 2580.0
            },
            "2": {
                "precision": 0.6105442176870748,
                "recall": 0.5604996096799375,
                "f1-score": 0.5844525844525844,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7165109034267912,
                "recall": 0.5336426914153132,
                "f1-score": 0.6117021276595744,
                "support": 431.0
            },
            "4": {
                "precision": 0.9700460829493087,
                "recall": 0.9611872146118722,
                "f1-score": 0.9655963302752294,
                "support": 438.0
            },
            "5": {
                "precision": 0.9381625441696113,
                "recall": 0.9389920424403183,
                "f1-score": 0.9385771100309325,
                "support": 2262.0
            },
            "6": {
                "precision": 0.731764705882353,
                "recall": 0.6850220264317181,
                "f1-score": 0.7076222980659841,
                "support": 454.0
            },
            "7": {
                "precision": 0.9140969162995595,
                "recall": 0.9194977843426884,
                "f1-score": 0.9167893961708394,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8440145102781137,
                "recall": 0.880201765447667,
                "f1-score": 0.8617283950617285,
                "support": 793.0
            },
            "accuracy": 0.8124431875568124,
            "macro avg": {
                "precision": 0.7938728243358629,
                "recall": 0.7575823064945401,
                "f1-score": 0.7725397887854357,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8095777325304007,
                "recall": 0.8124431875568124,
                "f1-score": 0.8093423781169421,
                "support": 9901.0
            },
            "cross-entropy": 0.5220071643668365,
            "score": 0.8124431875568124
        },
        "test": {
            "0": {
                "precision": 0.6732673267326733,
                "recall": 0.5284974093264249,
                "f1-score": 0.5921625544267054,
                "support": 386.0
            },
            "1": {
                "precision": 0.7412293011507157,
                "recall": 0.8191687344913151,
                "f1-score": 0.7782525416236924,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5924398625429553,
                "recall": 0.5384134915677702,
                "f1-score": 0.5641361256544503,
                "support": 1601.0
            },
            "3": {
                "precision": 0.7022332506203474,
                "recall": 0.5260223048327137,
                "f1-score": 0.6014877789585547,
                "support": 538.0
            },
            "4": {
                "precision": 0.9779005524861878,
                "recall": 0.968978102189781,
                "f1-score": 0.9734188817598532,
                "support": 548.0
            },
            "5": {
                "precision": 0.949182658137882,
                "recall": 0.9448178280863105,
                "f1-score": 0.9469952136146074,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7262569832402235,
                "recall": 0.6866197183098591,
                "f1-score": 0.7058823529411764,
                "support": 568.0
            },
            "7": {
                "precision": 0.909778812572759,
                "recall": 0.9232132309509746,
                "f1-score": 0.9164467897977133,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8480769230769231,
                "recall": 0.8900100908173562,
                "f1-score": 0.8685376661742984,
                "support": 991.0
            },
            "accuracy": 0.8101971557853911,
            "macro avg": {
                "precision": 0.7911517411734075,
                "recall": 0.7584156567302784,
                "f1-score": 0.7719244338834502,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8070737530742825,
                "recall": 0.8101971557853911,
                "f1-score": 0.8070651856274814,
                "support": 12376.0
            },
            "cross-entropy": 0.5202006126352133,
            "score": 0.8101971557853911
        }
    },
    "time": "0:00:47.644740",
    "chunk_size": null,
    "eval_batch_size": 32768
}