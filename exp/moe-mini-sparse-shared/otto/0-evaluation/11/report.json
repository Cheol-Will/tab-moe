{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 11,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.00019685063134956734,
            "weight_decay": 0.0041555015297345625
        },
        "model": {
            "arch_type": "moe-sparse-shared",
            "backbone": {
                "k": 4,
                "n_blocks": 1,
                "d_block": 672,
                "dropout": 0.31267695203955426,
                "moe_ratio": 0.25,
                "num_experts": 4
            }
        }
    },
    "n_parameters": 1879593,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 2886,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9049858889934148,
                "recall": 0.7789473684210526,
                "f1-score": 0.8372497824194952,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8172410690182669,
                "recall": 0.88020934289591,
                "f1-score": 0.8475572768419578,
                "support": 10318.0
            },
            "2": {
                "precision": 0.7083418733346998,
                "recall": 0.6747364310816087,
                "f1-score": 0.691130886911309,
                "support": 5122.0
            },
            "3": {
                "precision": 0.8762725137039937,
                "recall": 0.6498257839721254,
                "f1-score": 0.7462487495831944,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9768099547511312,
                "recall": 0.9851682829435254,
                "f1-score": 0.9809713149673389,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9782729187451502,
                "recall": 0.9755693124032722,
                "f1-score": 0.9769192450323794,
                "support": 9046.0
            },
            "6": {
                "precision": 0.8780623608017817,
                "recall": 0.8679141441937259,
                "f1-score": 0.8729587600332134,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9674736647569765,
                "recall": 0.966402067565073,
                "f1-score": 0.966937569264869,
                "support": 5417.0
            },
            "8": {
                "precision": 0.921173235563703,
                "recall": 0.9508041627246925,
                "f1-score": 0.9357541899441342,
                "support": 3171.0
            },
            "accuracy": 0.8837655614757203,
            "macro avg": {
                "precision": 0.892070386629902,
                "recall": 0.858841877355665,
                "f1-score": 0.8728586416664323,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.8839703144375444,
                "recall": 0.8837655614757203,
                "f1-score": 0.8826117985653652,
                "support": 39601.0
            },
            "cross-entropy": 0.2954384961176254,
            "score": 0.8837655614757203
        },
        "val": {
            "0": {
                "precision": 0.6926406926406926,
                "recall": 0.5194805194805194,
                "f1-score": 0.5936920222634509,
                "support": 308.0
            },
            "1": {
                "precision": 0.752936988252047,
                "recall": 0.8197674418604651,
                "f1-score": 0.7849322694377435,
                "support": 2580.0
            },
            "2": {
                "precision": 0.5981697171381032,
                "recall": 0.5612802498048399,
                "f1-score": 0.5791381393475635,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7142857142857143,
                "recall": 0.5452436194895591,
                "f1-score": 0.618421052631579,
                "support": 431.0
            },
            "4": {
                "precision": 0.9724137931034482,
                "recall": 0.9657534246575342,
                "f1-score": 0.9690721649484535,
                "support": 438.0
            },
            "5": {
                "precision": 0.9532374100719424,
                "recall": 0.9372236958443855,
                "f1-score": 0.9451627284886314,
                "support": 2262.0
            },
            "6": {
                "precision": 0.75,
                "recall": 0.7400881057268722,
                "f1-score": 0.7450110864745011,
                "support": 454.0
            },
            "7": {
                "precision": 0.9120403749098774,
                "recall": 0.9342688330871491,
                "f1-score": 0.9230207953301715,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8397129186602871,
                "recall": 0.8852459016393442,
                "f1-score": 0.8618784530386739,
                "support": 793.0
            },
            "accuracy": 0.8155741844258155,
            "macro avg": {
                "precision": 0.7983819565624569,
                "recall": 0.7675946435100742,
                "f1-score": 0.7800365235511966,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8133985040523476,
                "recall": 0.8155741844258155,
                "f1-score": 0.8130779044217564,
                "support": 9901.0
            },
            "cross-entropy": 0.5109604736828475,
            "score": 0.8155741844258155
        },
        "test": {
            "0": {
                "precision": 0.6830065359477124,
                "recall": 0.5414507772020726,
                "f1-score": 0.6040462427745665,
                "support": 386.0
            },
            "1": {
                "precision": 0.7614652437265648,
                "recall": 0.8188585607940446,
                "f1-score": 0.7891197130473772,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5870580386924616,
                "recall": 0.5496564647095565,
                "f1-score": 0.5677419354838709,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6912114014251781,
                "recall": 0.5408921933085502,
                "f1-score": 0.6068821689259645,
                "support": 538.0
            },
            "4": {
                "precision": 0.9674502712477396,
                "recall": 0.9762773722627737,
                "f1-score": 0.971843778383288,
                "support": 548.0
            },
            "5": {
                "precision": 0.9542039355992844,
                "recall": 0.9434029006013441,
                "f1-score": 0.9487726787620063,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7313691507798961,
                "recall": 0.7429577464788732,
                "f1-score": 0.737117903930131,
                "support": 568.0
            },
            "7": {
                "precision": 0.916519694297472,
                "recall": 0.9208505611340815,
                "f1-score": 0.9186800235710076,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8429517502365185,
                "recall": 0.8990918264379415,
                "f1-score": 0.8701171875,
                "support": 991.0
            },
            "accuracy": 0.8156108597285068,
            "macro avg": {
                "precision": 0.7928040024392031,
                "recall": 0.7703820447699153,
                "f1-score": 0.7793690702642458,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8129043391822534,
                "recall": 0.8156108597285068,
                "f1-score": 0.8131695528225868,
                "support": 12376.0
            },
            "cross-entropy": 0.5059247862126331,
            "score": 0.8156108597285068
        }
    },
    "time": "0:00:45.200296",
    "chunk_size": null,
    "eval_batch_size": 32768
}