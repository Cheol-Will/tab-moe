{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 10,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.00019685063134956734,
            "weight_decay": 0.0041555015297345625
        },
        "model": {
            "arch_type": "moe-sparse-shared",
            "backbone": {
                "k": 4,
                "n_blocks": 1,
                "d_block": 672,
                "dropout": 0.31267695203955426,
                "moe_ratio": 0.25,
                "num_experts": 4
            }
        }
    },
    "n_parameters": 1879593,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 5460,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9701492537313433,
                "recall": 0.9473684210526315,
                "f1-score": 0.9586235149528882,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8707513416815742,
                "recall": 0.9434968017057569,
                "f1-score": 0.9056656433156572,
                "support": 10318.0
            },
            "2": {
                "precision": 0.8499244223709782,
                "recall": 0.7684498242873877,
                "f1-score": 0.8071362657643801,
                "support": 5122.0
            },
            "3": {
                "precision": 0.953375086986778,
                "recall": 0.7955865272938444,
                "f1-score": 0.8673630895853118,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9892106757524134,
                "recall": 0.9937250427837993,
                "f1-score": 0.991462720546386,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9935741192111678,
                "recall": 0.9913774043776254,
                "f1-score": 0.9924745462594068,
                "support": 9046.0
            },
            "6": {
                "precision": 0.9539144919489173,
                "recall": 0.945514584479912,
                "f1-score": 0.9496959646213378,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9905204460966542,
                "recall": 0.9837548458556397,
                "f1-score": 0.9871260535333889,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9770368040264235,
                "recall": 0.9795017344686219,
                "f1-score": 0.9782677165354331,
                "support": 3171.0
            },
            "accuracy": 0.9361884800888867,
            "macro avg": {
                "precision": 0.94982851575625,
                "recall": 0.9276416873672465,
                "f1-score": 0.93753505723491,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.936759800356729,
                "recall": 0.9361884800888867,
                "f1-score": 0.9355120973114425,
                "support": 39601.0
            },
            "cross-entropy": 0.17544836248604098,
            "score": 0.9361884800888867
        },
        "val": {
            "0": {
                "precision": 0.6704545454545454,
                "recall": 0.5746753246753247,
                "f1-score": 0.6188811188811189,
                "support": 308.0
            },
            "1": {
                "precision": 0.7557172557172557,
                "recall": 0.8453488372093023,
                "f1-score": 0.7980241492864985,
                "support": 2580.0
            },
            "2": {
                "precision": 0.6216457960644007,
                "recall": 0.5425448868071819,
                "f1-score": 0.5794080867027929,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7069486404833837,
                "recall": 0.54292343387471,
                "f1-score": 0.6141732283464567,
                "support": 431.0
            },
            "4": {
                "precision": 0.9767441860465116,
                "recall": 0.958904109589041,
                "f1-score": 0.967741935483871,
                "support": 438.0
            },
            "5": {
                "precision": 0.9495949594959496,
                "recall": 0.9328028293545535,
                "f1-score": 0.9411239964317573,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7274725274725274,
                "recall": 0.7290748898678414,
                "f1-score": 0.7282728272827282,
                "support": 454.0
            },
            "7": {
                "precision": 0.9123188405797101,
                "recall": 0.9298375184638109,
                "f1-score": 0.9209948792977323,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8515337423312883,
                "recall": 0.8751576292559899,
                "f1-score": 0.8631840796019901,
                "support": 793.0
            },
            "accuracy": 0.8182001817998182,
            "macro avg": {
                "precision": 0.7969367215161748,
                "recall": 0.7701410510108617,
                "f1-score": 0.781311589034994,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8154620640048209,
                "recall": 0.8182001817998182,
                "f1-score": 0.8152014405826268,
                "support": 9901.0
            },
            "cross-entropy": 0.5779789102341829,
            "score": 0.8182001817998182
        },
        "test": {
            "0": {
                "precision": 0.6628571428571428,
                "recall": 0.6010362694300518,
                "f1-score": 0.6304347826086957,
                "support": 386.0
            },
            "1": {
                "precision": 0.7602372211239763,
                "recall": 0.8349875930521092,
                "f1-score": 0.7958610495195861,
                "support": 3224.0
            },
            "2": {
                "precision": 0.6099290780141844,
                "recall": 0.5371642723297939,
                "f1-score": 0.5712387910993026,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6856492027334852,
                "recall": 0.5594795539033457,
                "f1-score": 0.6161719549641761,
                "support": 538.0
            },
            "4": {
                "precision": 0.9709618874773139,
                "recall": 0.9762773722627737,
                "f1-score": 0.9736123748862602,
                "support": 548.0
            },
            "5": {
                "precision": 0.9492007104795737,
                "recall": 0.9451715599575522,
                "f1-score": 0.9471818504076569,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7385740402193784,
                "recall": 0.7112676056338029,
                "f1-score": 0.7246636771300449,
                "support": 568.0
            },
            "7": {
                "precision": 0.92599171107164,
                "recall": 0.9238038984051978,
                "f1-score": 0.9248965109402721,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8558994197292069,
                "recall": 0.893037336024218,
                "f1-score": 0.874074074074074,
                "support": 991.0
            },
            "accuracy": 0.8197317388493859,
            "macro avg": {
                "precision": 0.7954778237451001,
                "recall": 0.7758028289998716,
                "f1-score": 0.7842372295144522,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8163486790983953,
                "recall": 0.8197317388493859,
                "f1-score": 0.8169155225951911,
                "support": 12376.0
            },
            "cross-entropy": 0.5793499280921914,
            "score": 0.8197317388493859
        }
    },
    "time": "0:01:13.285819",
    "chunk_size": null,
    "eval_batch_size": 32768
}