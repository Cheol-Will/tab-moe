{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 6,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.00019685063134956734,
            "weight_decay": 0.0041555015297345625
        },
        "model": {
            "arch_type": "moe-sparse-shared",
            "backbone": {
                "k": 4,
                "n_blocks": 1,
                "d_block": 672,
                "dropout": 0.31267695203955426,
                "moe_ratio": 0.25,
                "num_experts": 4
            }
        }
    },
    "n_parameters": 1879593,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 2028,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.8258527827648114,
                "recall": 0.7449392712550608,
                "f1-score": 0.7833120476798638,
                "support": 1235.0
            },
            "1": {
                "precision": 0.7924443242268506,
                "recall": 0.8518123667377399,
                "f1-score": 0.8210565649960297,
                "support": 10318.0
            },
            "2": {
                "precision": 0.658157159952134,
                "recall": 0.6442795782897306,
                "f1-score": 0.6511444356748224,
                "support": 5122.0
            },
            "3": {
                "precision": 0.8538932633420823,
                "recall": 0.5667828106852497,
                "f1-score": 0.681326352530541,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9805603201829617,
                "recall": 0.9783228750713063,
                "f1-score": 0.9794403198172473,
                "support": 1753.0
            },
            "5": {
                "precision": 0.9637855579868709,
                "recall": 0.9738005748397082,
                "f1-score": 0.968767183547784,
                "support": 9046.0
            },
            "6": {
                "precision": 0.8288682340076544,
                "recall": 0.8343423225096313,
                "f1-score": 0.8315962698848052,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9588224333892305,
                "recall": 0.9499723093963448,
                "f1-score": 0.9543768545994065,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9169308814204186,
                "recall": 0.9120151371807,
                "f1-score": 0.9144664031620554,
                "support": 3171.0
            },
            "accuracy": 0.8601550465897326,
            "macro avg": {
                "precision": 0.8643683285858904,
                "recall": 0.8284741384406079,
                "f1-score": 0.8428318257658396,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.8606540951873075,
                "recall": 0.8601550465897326,
                "f1-score": 0.8587795112821176,
                "support": 39601.0
            },
            "cross-entropy": 0.35376294858608726,
            "score": 0.8601550465897326
        },
        "val": {
            "0": {
                "precision": 0.6450381679389313,
                "recall": 0.5487012987012987,
                "f1-score": 0.5929824561403509,
                "support": 308.0
            },
            "1": {
                "precision": 0.7569241982507289,
                "recall": 0.8050387596899224,
                "f1-score": 0.7802404207362885,
                "support": 2580.0
            },
            "2": {
                "precision": 0.5816640986132512,
                "recall": 0.5893832943013271,
                "f1-score": 0.5854982551376502,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7449664429530202,
                "recall": 0.5150812064965197,
                "f1-score": 0.6090534979423868,
                "support": 431.0
            },
            "4": {
                "precision": 0.9813519813519813,
                "recall": 0.9611872146118722,
                "f1-score": 0.9711649365628604,
                "support": 438.0
            },
            "5": {
                "precision": 0.9437306158617634,
                "recall": 0.9416445623342176,
                "f1-score": 0.9426864350520027,
                "support": 2262.0
            },
            "6": {
                "precision": 0.724669603524229,
                "recall": 0.724669603524229,
                "f1-score": 0.7246696035242289,
                "support": 454.0
            },
            "7": {
                "precision": 0.9222873900293255,
                "recall": 0.9290989660265879,
                "f1-score": 0.9256806475349522,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8641509433962264,
                "recall": 0.8663303909205549,
                "f1-score": 0.8652392947103275,
                "support": 793.0
            },
            "accuracy": 0.8128471871528129,
            "macro avg": {
                "precision": 0.7960870491021619,
                "recall": 0.7645705885118366,
                "f1-score": 0.7774683941490053,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8125773234595282,
                "recall": 0.8128471871528129,
                "f1-score": 0.81147535806536,
                "support": 9901.0
            },
            "cross-entropy": 0.49176056191902856,
            "score": 0.8128471871528129
        },
        "test": {
            "0": {
                "precision": 0.6608695652173913,
                "recall": 0.5906735751295337,
                "f1-score": 0.6238030095759233,
                "support": 386.0
            },
            "1": {
                "precision": 0.7513513513513513,
                "recall": 0.8191687344913151,
                "f1-score": 0.7837958154028788,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5793285055957867,
                "recall": 0.5496564647095565,
                "f1-score": 0.5641025641025642,
                "support": 1601.0
            },
            "3": {
                "precision": 0.7408450704225352,
                "recall": 0.4888475836431227,
                "f1-score": 0.5890257558790595,
                "support": 538.0
            },
            "4": {
                "precision": 0.9779816513761468,
                "recall": 0.9726277372262774,
                "f1-score": 0.9752973467520586,
                "support": 548.0
            },
            "5": {
                "precision": 0.9410112359550562,
                "recall": 0.948001414927485,
                "f1-score": 0.9444933920704845,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7361853832442068,
                "recall": 0.727112676056338,
                "f1-score": 0.7316209034543844,
                "support": 568.0
            },
            "7": {
                "precision": 0.924404761904762,
                "recall": 0.9173065564087419,
                "f1-score": 0.9208419804328491,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8561507936507936,
                "recall": 0.8708375378405651,
                "f1-score": 0.8634317158579289,
                "support": 991.0
            },
            "accuracy": 0.8123787976729153,
            "macro avg": {
                "precision": 0.7964587020797811,
                "recall": 0.7649146978258817,
                "f1-score": 0.7773791648364591,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8105462749976833,
                "recall": 0.8123787976729153,
                "f1-score": 0.8098353647543493,
                "support": 12376.0
            },
            "cross-entropy": 0.48878223523275444,
            "score": 0.8123787976729153
        }
    },
    "time": "0:00:35.996544",
    "chunk_size": null,
    "eval_batch_size": 32768
}