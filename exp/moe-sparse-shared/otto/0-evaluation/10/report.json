{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 10,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0001371575095928092,
            "weight_decay": 0.0
        },
        "model": {
            "arch_type": "moe-sparse-shared",
            "backbone": {
                "k": 10,
                "n_blocks": 2,
                "d_block": 272,
                "dropout": 0.29582998525319965,
                "moe_ratio": 0.5,
                "num_experts": 48
            }
        }
    },
    "n_parameters": 7453625,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 3744,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.9330316742081448,
                "recall": 0.8348178137651822,
                "f1-score": 0.8811965811965812,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8286837670848156,
                "recall": 0.8579182012017833,
                "f1-score": 0.8430476190476192,
                "support": 10318.0
            },
            "2": {
                "precision": 0.6831777481425033,
                "recall": 0.7001171417415072,
                "f1-score": 0.6915437277022467,
                "support": 5122.0
            },
            "3": {
                "precision": 0.8749063670411985,
                "recall": 0.6782810685249709,
                "f1-score": 0.7641478573765128,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9851851851851852,
                "recall": 0.9863091842555619,
                "f1-score": 0.9857468643101481,
                "support": 1753.0
            },
            "5": {
                "precision": 0.983610188261351,
                "recall": 0.9818704399734689,
                "f1-score": 0.982739544146935,
                "support": 9046.0
            },
            "6": {
                "precision": 0.9023849140321686,
                "recall": 0.895432030820033,
                "f1-score": 0.8988950276243094,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9786918658513989,
                "recall": 0.9750784567103563,
                "f1-score": 0.9768818198631405,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9414483821263482,
                "recall": 0.9634184799747714,
                "f1-score": 0.9523067331670823,
                "support": 3171.0
            },
            "accuracy": 0.8891694654175399,
            "macro avg": {
                "precision": 0.9012355657703459,
                "recall": 0.8748047574408484,
                "f1-score": 0.8862784193816194,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.8903761484542555,
                "recall": 0.8891694654175399,
                "f1-score": 0.8890556955268317,
                "support": 39601.0
            },
            "cross-entropy": 0.27115958891193576,
            "score": 0.8891694654175399
        },
        "val": {
            "0": {
                "precision": 0.6652719665271967,
                "recall": 0.5162337662337663,
                "f1-score": 0.5813528336380256,
                "support": 308.0
            },
            "1": {
                "precision": 0.7645101663585951,
                "recall": 0.8015503875968992,
                "f1-score": 0.7825922421948912,
                "support": 2580.0
            },
            "2": {
                "precision": 0.5874713521772346,
                "recall": 0.600312256049961,
                "f1-score": 0.5938223938223939,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7246835443037974,
                "recall": 0.531322505800464,
                "f1-score": 0.6131191432396252,
                "support": 431.0
            },
            "4": {
                "precision": 0.9790697674418605,
                "recall": 0.9611872146118722,
                "f1-score": 0.9700460829493087,
                "support": 438.0
            },
            "5": {
                "precision": 0.9461883408071748,
                "recall": 0.9328028293545535,
                "f1-score": 0.9394479073909171,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7130242825607064,
                "recall": 0.711453744493392,
                "f1-score": 0.7122381477398015,
                "support": 454.0
            },
            "7": {
                "precision": 0.9046242774566474,
                "recall": 0.9246676514032496,
                "f1-score": 0.914536157779401,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8359281437125748,
                "recall": 0.880201765447667,
                "f1-score": 0.8574938574938575,
                "support": 793.0
            },
            "accuracy": 0.810928189071811,
            "macro avg": {
                "precision": 0.7911968712606431,
                "recall": 0.7621924578879806,
                "f1-score": 0.773849862916469,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8103025253608548,
                "recall": 0.810928189071811,
                "f1-score": 0.8094765732144183,
                "support": 9901.0
            },
            "cross-entropy": 0.5859749662255547,
            "score": 0.810928189071811
        },
        "test": {
            "0": {
                "precision": 0.6578073089700996,
                "recall": 0.5129533678756477,
                "f1-score": 0.576419213973799,
                "support": 386.0
            },
            "1": {
                "precision": 0.7689291101055807,
                "recall": 0.7906327543424317,
                "f1-score": 0.7796299128307081,
                "support": 3224.0
            },
            "2": {
                "precision": 0.566060606060606,
                "recall": 0.5833853841349157,
                "f1-score": 0.5745924330975085,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6900726392251816,
                "recall": 0.5297397769516728,
                "f1-score": 0.5993690851735015,
                "support": 538.0
            },
            "4": {
                "precision": 0.9779005524861878,
                "recall": 0.968978102189781,
                "f1-score": 0.9734188817598532,
                "support": 548.0
            },
            "5": {
                "precision": 0.9427157001414427,
                "recall": 0.9430491687301026,
                "f1-score": 0.9428824049513703,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7319223985890653,
                "recall": 0.7306338028169014,
                "f1-score": 0.7312775330396475,
                "support": 568.0
            },
            "7": {
                "precision": 0.9075581395348837,
                "recall": 0.9220318960425281,
                "f1-score": 0.9147377673600939,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8373435996150145,
                "recall": 0.8779011099899092,
                "f1-score": 0.8571428571428571,
                "support": 991.0
            },
            "accuracy": 0.8087427278603749,
            "macro avg": {
                "precision": 0.7867011171920069,
                "recall": 0.7621450403415433,
                "f1-score": 0.7721633432588155,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8074858863413821,
                "recall": 0.8087427278603749,
                "f1-score": 0.8072733569093568,
                "support": 12376.0
            },
            "cross-entropy": 0.5793183479167959,
            "score": 0.8087427278603749
        }
    },
    "time": "0:01:16.560499",
    "chunk_size": null,
    "eval_batch_size": 32768
}