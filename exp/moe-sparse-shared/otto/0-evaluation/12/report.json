{
    "function": "bin.model.main",
    "gpus": [
        "NVIDIA GeForce RTX 4090"
    ],
    "config": {
        "seed": 12,
        "batch_size": 512,
        "patience": 16,
        "n_epochs": -1,
        "gradient_clipping_norm": 1.0,
        "amp": true,
        "data": {
            "cache": true,
            "path": "data/otto"
        },
        "optimizer": {
            "type": "AdamW",
            "lr": 0.0001371575095928092,
            "weight_decay": 0.0
        },
        "model": {
            "arch_type": "moe-sparse-shared",
            "backbone": {
                "k": 10,
                "n_blocks": 2,
                "d_block": 272,
                "dropout": 0.29582998525319965,
                "moe_ratio": 0.5,
                "num_experts": 48
            }
        }
    },
    "n_parameters": 7453625,
    "prediction_type": "probs",
    "epoch_size": 78,
    "best_step": 3198,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.8889891696750902,
                "recall": 0.7975708502024291,
                "f1-score": 0.8408023900981648,
                "support": 1235.0
            },
            "1": {
                "precision": 0.8189703941165378,
                "recall": 0.8418298119790657,
                "f1-score": 0.8302427834066144,
                "support": 10318.0
            },
            "2": {
                "precision": 0.6638719512195121,
                "recall": 0.6802030456852792,
                "f1-score": 0.6719382835101254,
                "support": 5122.0
            },
            "3": {
                "precision": 0.8532526475037822,
                "recall": 0.6550522648083623,
                "f1-score": 0.7411300919842313,
                "support": 1722.0
            },
            "4": {
                "precision": 0.9823059360730594,
                "recall": 0.9817455790074159,
                "f1-score": 0.9820256776034237,
                "support": 1753.0
            },
            "5": {
                "precision": 0.98,
                "recall": 0.9750165819146585,
                "f1-score": 0.9775019394879751,
                "support": 9046.0
            },
            "6": {
                "precision": 0.8511552928533047,
                "recall": 0.8717666483214089,
                "f1-score": 0.8613376835236541,
                "support": 1817.0
            },
            "7": {
                "precision": 0.9579938439254029,
                "recall": 0.9767398929296659,
                "f1-score": 0.9672760511882998,
                "support": 5417.0
            },
            "8": {
                "precision": 0.9371266897202137,
                "recall": 0.9400819930621255,
                "f1-score": 0.9386020151133501,
                "support": 3171.0
            },
            "accuracy": 0.8757354612257267,
            "macro avg": {
                "precision": 0.881518436120767,
                "recall": 0.8577785186567123,
                "f1-score": 0.8678729906573155,
                "support": 39601.0
            },
            "weighted avg": {
                "precision": 0.8765532234763835,
                "recall": 0.8757354612257267,
                "f1-score": 0.8754272716627697,
                "support": 39601.0
            },
            "cross-entropy": 0.3011568818636588,
            "score": 0.8757354612257267
        },
        "val": {
            "0": {
                "precision": 0.6235294117647059,
                "recall": 0.5162337662337663,
                "f1-score": 0.5648312611012433,
                "support": 308.0
            },
            "1": {
                "precision": 0.7699248120300752,
                "recall": 0.7937984496124031,
                "f1-score": 0.7816793893129771,
                "support": 2580.0
            },
            "2": {
                "precision": 0.5872894333843798,
                "recall": 0.5987509758001561,
                "f1-score": 0.592964824120603,
                "support": 1281.0
            },
            "3": {
                "precision": 0.7202380952380952,
                "recall": 0.5614849187935035,
                "f1-score": 0.6310299869621904,
                "support": 431.0
            },
            "4": {
                "precision": 0.9768518518518519,
                "recall": 0.9634703196347032,
                "f1-score": 0.9701149425287355,
                "support": 438.0
            },
            "5": {
                "precision": 0.9456912028725314,
                "recall": 0.9314765694076039,
                "f1-score": 0.9385300668151447,
                "support": 2262.0
            },
            "6": {
                "precision": 0.7177777777777777,
                "recall": 0.711453744493392,
                "f1-score": 0.7146017699115044,
                "support": 454.0
            },
            "7": {
                "precision": 0.9016277423920736,
                "recall": 0.9409158050221565,
                "f1-score": 0.9208529092880375,
                "support": 1354.0
            },
            "8": {
                "precision": 0.8416565164433617,
                "recall": 0.8713745271122321,
                "f1-score": 0.8562577447335812,
                "support": 793.0
            },
            "accuracy": 0.8113321886678113,
            "macro avg": {
                "precision": 0.7871763159727614,
                "recall": 0.7654398973455464,
                "f1-score": 0.7745403216415574,
                "support": 9901.0
            },
            "weighted avg": {
                "precision": 0.8102531826009973,
                "recall": 0.8113321886678113,
                "f1-score": 0.8100600451650196,
                "support": 9901.0
            },
            "cross-entropy": 0.5651353892192442,
            "score": 0.8113321886678113
        },
        "test": {
            "0": {
                "precision": 0.6528662420382165,
                "recall": 0.5310880829015544,
                "f1-score": 0.5857142857142856,
                "support": 386.0
            },
            "1": {
                "precision": 0.7790307832977751,
                "recall": 0.792803970223325,
                "f1-score": 0.7858570330514988,
                "support": 3224.0
            },
            "2": {
                "precision": 0.5726548129981607,
                "recall": 0.5833853841349157,
                "f1-score": 0.577970297029703,
                "support": 1601.0
            },
            "3": {
                "precision": 0.6628175519630485,
                "recall": 0.533457249070632,
                "f1-score": 0.5911431513903191,
                "support": 538.0
            },
            "4": {
                "precision": 0.9743119266055046,
                "recall": 0.968978102189781,
                "f1-score": 0.9716376944190303,
                "support": 548.0
            },
            "5": {
                "precision": 0.9455516014234876,
                "recall": 0.9398655818889282,
                "f1-score": 0.9427000177399326,
                "support": 2827.0
            },
            "6": {
                "precision": 0.7118055555555556,
                "recall": 0.721830985915493,
                "f1-score": 0.7167832167832168,
                "support": 568.0
            },
            "7": {
                "precision": 0.8896473265073948,
                "recall": 0.9238038984051978,
                "f1-score": 0.9064039408866994,
                "support": 1693.0
            },
            "8": {
                "precision": 0.8433852140077821,
                "recall": 0.8748738647830474,
                "f1-score": 0.8588410104011885,
                "support": 991.0
            },
            "accuracy": 0.8089043309631545,
            "macro avg": {
                "precision": 0.7813412238218805,
                "recall": 0.7633430132792083,
                "f1-score": 0.7707834052684305,
                "support": 12376.0
            },
            "weighted avg": {
                "precision": 0.8072307977345876,
                "recall": 0.8089043309631545,
                "f1-score": 0.8074750191411068,
                "support": 12376.0
            },
            "cross-entropy": 0.5559338655321405,
            "score": 0.8089043309631545
        }
    },
    "time": "0:01:08.426284",
    "chunk_size": null,
    "eval_batch_size": 32768
}